{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{\"Xm+O\":function(t,e,s){\"use strict\";s.d(e,\"a\",function(){return a}),s(\"OHOg\"),s(\"5aMp\");var i=s(\"lcOY\"),o=s(\"f8yE\"),n=(s(\"iNCl\"),s(\"LWby\"),s(\"Ouoq\"),s(\"FoyA\")),a=function(){function t(t,e,s,o,n,a){this.request=t,this.warn=e,this.makes=s,this.modal=o,this.config=n,this.user=a,this.pageNo=i.a.PAGE.PAGE_NO,this.pageSize=i.a.PAGE.PAGE_SIZE,this.total=i.a.PAGE.PAGE_TOTAL,this.category=\"\",this.projectName=\"\",this.selectModuleIds=[],this.selectModules=[],this.selectModulesAll=!1}return t.prototype.ngOnInit=function(){this.changeData(),this.loadCategory()},t.prototype.changeData=function(){var t=this;t.versionId&&t.request.doPost({url:\"moduleListQuote\",data:{versionId:t.versionId,pageNo:t.pageNo,pageSize:t.pageSize,category:t.category,projectName:t.projectName,companyId:t.user.getCompanyId(),versionType:Object(n.x)(t.type)},success:function(e){e&&200==e.code?(t.moduleList=e.data.pageSet,t.total=e.data.total,t.makes.addMakings(t.moduleList)):t.warn.onError(e.msg||o.a.FAIL.DATA)}})},t.prototype.ngDoCheck=function(){this.config.getConfigBase()&&!this.configBase?this.configBase=this.config.getConfigBase():this.title=this.title?this.title:this.getName()},t.prototype.searchData=function(){this.pageNo=i.a.PAGE.PAGE_NO,this.total=i.a.PAGE.PAGE_TOTAL,this.selectModuleIds=[],this.changeData()},t.prototype.loadCategory=function(){var t=this;t.request.doPost({url:\"categoryList\",data:{versionId:t.versionId},success:function(e){e&&200===e.code?t.categoryList=e.data:t.warn.onError(e.msg||o.a.FAIL.DATA)}})},t.prototype.selectModule=function(t){this.existModuleId(t.id)?this.selectModuleIds.splice(this.selectModuleIds.indexOf(t.id),1):this.selectModuleIds.push(t.id)},t.prototype.existModuleId=function(t){var e=this.selectModuleIds;if(e&&e.length>0)for(var s=0;s<e.length;s++)if(e[s]==t)return!0;return!1},t.prototype.existModuleById=function(t){var e=this.selectModules;if(e&&e.length>0)for(var s=0,i=e;s<i.length;s++)if(i[s].id==t)return!0},t.prototype.findModuleById=function(t){return 0},t.prototype.cancel=function(){this.resetIds(),this.modal.dismiss({type:this.type,versionId:this.versionId})},t.prototype.send=function(){var t=this,e={};t.selectModuleIds.length>0?(e.infoIds=t.selectModuleIds,3===t.type||2===t.type||5===t.type?e.type=t.type:(e.type=1,e.infoBranchName=t.infoName?t.infoName:\"\"),t.pauseId?(e.pauseId=t.pauseId,t.request.doPost({url:\"addPause\",data:e,success:function(e){e&&200==e.code?(t.warn.onSuccess(e.msg||o.a.SUCCESS.DATA),t.resetIds(),t.modal.close(e)):t.warn.onError(e.msg||o.a.FAIL.DATA)}})):(e.id=t.offerId,t.request.doPost({url:\"addBasicQuote\",data:e,success:function(e){e&&200==e.code?(t.warn.onSuccess(e.msg||o.a.SUCCESS.DATA),t.resetIds(),t.modal.close(JSON.stringify(e.data[0]))):t.warn.onError(e.msg||o.a.FAIL.DATA)}}))):t.warn.onWarn(o.a.SELECT_NOT_EMPTY)},t.prototype.sendTo=function(){if(5===this.type){var t=this.makes.getMarkings(),e=[];if(this.selectModuleIds&&this.selectModuleIds.length>0&&t.length>0)for(var s=0;s<this.selectModuleIds.length;s++)for(var i=0,o=t;i<o.length;i++){var n=o[i];this.selectModuleIds[s]===n.id&&(n.remark=\"\",e.push(n))}this.modal.close({modules:e,versionId:this.versionId,category:this.category,projectName:this.projectName})}},t.prototype.resetIds=function(){this.selectModuleIds=[],this.pageNo=i.a.PAGE.PAGE_NO,this.projectName=\"\",this.category=\"\"},t.prototype.selectModuleAll=function(){var t=this,e=this;e.versionId?e.request.doPost({url:\"moduleFoldIds\",data:{versionId:e.versionId,category:e.category,projectName:e.projectName,companyId:e.user.getCompanyId(),versionType:e.type},success:function(s){s&&200==s.code?e.request.doPost({url:\"moduleListQuote\",data:{versionId:e.versionId,pageNo:e.pageNo,pageSize:s.data.length?s.data.length:i.a.PAGE.PAGE_SIZE,category:e.category,projectName:e.projectName},success:function(s){s&&200==s.code?s.data&&s.data.pageSet&&(e.selectModules.push(s.data.pageSet),e.makes.addMakings(s.data.pageSet)):t.warn.onError(s.msg||o.a.FAIL.DATA)}}):e.warn.onError(s.msg||o.a.FAIL.DATA)}}):this.selectModuleIds=[]},t.prototype.getName=function(){var t=\"\";if(this.configBase&&this.configBase&&this.configBase.length>0)for(var e=0,s=this.configBase;e<s.length;e++){var i=s[e];if(this.versionId&&!t&&i.versions&&i.versions.length>0)for(var o=0,n=i.versions;o<n.length;o++){var a=n[o];a.versionId===Number(this.versionId)&&(t=a.name)}}return t||\"\\u7248\\u672c\\u540d\\u79f0\"},t}()},XsMc:function(t,e,s){\"use strict\";s.d(e,\"a\",function(){return i});var i=function(){function t(t){this.activeModal=t,this.cancelIds=[]}return t.prototype.ngOnInit=function(){this.title=\"\\u8bf7\\u52fe\\u9009\\u9700\\u8981\\u8ba1\\u7b97\\u5de5\\u7a0b\\u7ba1\\u7406\\u8d39\\u7684\\u9879\\u76ee\"},t.prototype.getTotal=function(t,e){var s=0,i=this.getInfoByType(t);if(i&&i.length>0)for(var o=0,n=i;o<n.length;o++){var a=n[o];a.engineerYn===e&&(s+=Number(a.totalPrice))}return Number(100*s/100)},t.prototype.getInfoByType=function(t){var e=[];if(this.data&&this.data.length>0)for(var s=0,i=this.data;s<i.length;s++){var o=i[s];if(o.type===t){e=o.infos;break}}return e},t.prototype.getTotalSeries=function(){var t=0;if(this.data&&this.data.length>0)for(var e=0,s=this.data;e<s.length;e++){var i=s[e];if(1===i.type&&2===i.versionType){if(i.infoMaps&&i.infoMaps.length>0)for(var o=0,n=i.infoMaps;o<n.length;o++){var a=n[o];if(a.infos&&a.infos.length>0)for(var r=0,l=a.infos;r<l.length;r++)t+=Number(l[r].totalPrice)}}else 1===i.type&&2!==i.versionType&&(t=i.smallTotal)}return Number(100*t/100)},t.prototype.toggleCheck=function(t){var e=0;if(t&&t.length>0){for(var s=0,i=t;s<i.length;s++)i[s].engineerYn&&e++;return t.length===e}return!1},t.prototype.getTotalChecked=function(){var t,e=0;return e+=Number(this.getTotal(2,!0)),e+=Number(this.getTotal(3,!0)),e+=Number(this.getTotal(4,!0)),e+=Number(this.getTotalSeries()),(t=String(e*this.radio*100/100)).lastIndexOf(\".\")>0?t.substring(0,t.lastIndexOf(\".\")+3):t},t.prototype.getTotalUnchecked=function(){var t,e=0;return e+=Number(this.getTotal(2,!1)),e+=Number(this.getTotal(3,!1)),e+=Number(this.getTotal(4,!1)),(t=String(100*e/100)).lastIndexOf(\".\")>0?t.substring(0,t.lastIndexOf(\".\")+3):t},t.prototype.toggleInfo=function(t){t.engineerYn=!t.engineerYn,this.setCancelId(t.id)},t.prototype.toggleAll=function(t,e){var s=this;t&&t.length&&t.forEach(function(t){t.engineerYn=!e,t.engineerYn?s.removeCancelId(t.id):s.addCancelId(t.id)})},t.prototype.setCancelId=function(t){if(0==this.cancelIds.length)this.cancelIds.push(t);else if(-1==this.cancelIds.indexOf(t))this.cancelIds.push(t);else for(var e=0;e<this.cancelIds.length;e++)this.cancelIds[e]===t&&this.cancelIds.splice(e,1)},t.prototype.removeCancelId=function(t){if(this.cancelIds&&this.cancelIds.length>0)for(var e=0;e<this.cancelIds.length;e++)this.cancelIds[e]===t&&this.cancelIds.splice(e,1)},t.prototype.addCancelId=function(t){0==this.cancelIds.length&&this.cancelIds.push(t),this.cancelIds&&this.cancelIds.length>0&&-1==this.cancelIds.indexOf(t)&&this.cancelIds.push(t)},t.prototype.ok=function(){var t=[];this.data&&this.data.length>0&&this.data.forEach(function(e){2!==e.type&&3!==e.type&&4!==e.type||e.infos&&e.infos.length>0&&e.infos.forEach(function(e){e.engineerYn||t.push(e.id)})}),this.activeModal.close(t)},t}()},c0u4:function(t,e,s){\"use strict\";s.d(e,\"a\",function(){return a}),s(\"OHOg\"),s(\"LWby\");var i=s(\"f8yE\"),o=(s(\"5aMp\"),s(\"iNCl\"),s(\"lcOY\")),n=s(\"FoyA\"),a=(s(\"Ouoq\"),s(\"JQBr\"),function(){function t(t,e,s,i,n,a,r,l){this.request=t,this.warn=e,this.makes=s,this.modal=i,this.config=n,this.user=a,this.el=r,this.cookie=l,this.pageNo=o.a.PAGE.PAGE_NO,this.pageSize=o.a.PAGE.PAGE_SIZE,this.total=o.a.PAGE.PAGE_TOTAL,this.category=\"\",this.projectName=\"\",this.versionId=-1,this.selectModuleIds=[],this.selectModules=[],this.toggleModule=!1,this.balls=[{show:!1},{show:!1},{show:!1},{show:!1}],this.loadAll=!1,this.clickSelectAll=!1}return t.prototype.ngOnInit=function(){if(this.config.getConfigBase()||this.config.loadConfig(this.id),this.cookie.get(\"basic\"+this.type)){var t=JSON.parse(this.cookie.get(\"basic\"+this.type));this.versionId=t.versionId,this.versionId>0&&(this.loadCategory(),this.category=t.category),this.projectName=t.projectName}this.changeData()},t.prototype.changeChildOptions=function(){if(this.configBase&&this.configBase.length>0)for(var t=0,e=this.configBase;t<e.length;t++){var s=e[t];this.getSelectType()&&s.type==this.getSelectType()&&(this.changeOptions=s.versions)}},t.prototype.changeVersion=function(){this.pageNo=o.a.PAGE.PAGE_NO,this.projectName=\"\",this.category=\"\",this.toggleModule=!1,this.versionId>0?(this.loadCategory(),this.clickSelectAll=!1):(this.categoryList=[],this.moduleList=[]),this.changeData()},t.prototype.changeData=function(){var t=this,e={pageNo:t.pageNo,pageSize:t.pageSize,category:t.category,projectName:t.projectName,companyId:t.user.getCompanyId(),versionType:t.getSelectType()};t.versionId>0&&(e.versionId=t.versionId),t.request.doPost({url:\"moduleListQuote\",data:e,success:function(e){e&&200==e.code?(t.moduleList=e.data.pageSet,t.total=e.data.total):t.warn.onError(e.msg||i.a.FAIL.DATA)}})},t.prototype.ngDoCheck=function(){this.config.getConfigBase()&&!this.configBase&&(this.configBase=this.config.getConfigBase(),this.changeChildOptions()),this.switch=this.toggleModule?\"down\":\"up\"},t.prototype.searchData=function(){this.pageNo=o.a.PAGE.PAGE_NO,this.total=o.a.PAGE.PAGE_TOTAL,this.selectModuleIds=[],this.toggleModule=!1,this.changeData(),this.loadAll=!0,this.clickSelectAll=!1},t.prototype.loadCategory=function(){var t=this;t.versionId>0&&t.request.doPost({url:\"categoryList\",data:{versionId:t.versionId},success:function(e){e&&200===e.code?t.categoryList=e.data:t.warn.onError(e.msg||i.a.FAIL.DATA)}})},t.prototype.selectModule=function(t,e){for(var s,i=this,o=t.target,n=this.el.nativeElement.querySelectorAll(\".ball\"),a=this.el.nativeElement.querySelector(\".item-content\"),r={x:o.offsetLeft+o.offsetWidth/2,y:o.offsetTop+o.offsetHeight/2-a.scrollTop},l=this.getEndPoint(),c=l.x-240,h=((r.y-l.y)*(r.x-c)-(r.y-(l.y-40))*(r.x-l.x))/((r.x*r.x-l.x*l.x)*(r.x-c)-(r.x*r.x-c*c)*(r.x-l.x)),u=(l.y-r.y-h*(l.x*l.x-r.x*r.x))/(l.x-r.x),d=r.y-h*r.x*r.x-u*r.x,g=-1,p=0;p<i.balls.length;p++)if(!i.balls[p].show){i.balls[p].show=!0,s=n[p],(g=p)>=i.balls.length-1&&i.balls.push({show:!1});break}var f=r.x,m=r.y;s.style.left=f+\"px\",s.style.top=m+\"px\";var y=setInterval(function(){f<l.x?(s.style.left=(f+=10*(g+1))+\"px\",s.style.top=h*f*f+u*f+d+\"px\"):(e.num=1,i.selectModules.push(e),clearInterval(y),s.style=null,i.balls[g].show=!1)},5*(g+1))},t.prototype.getEndPoint=function(){var t=this.el.nativeElement.querySelector(\"#count\");return{x:t.offsetLeft+t.offsetWidth,y:t.offsetTop+t.offsetHeight/2+70}},t.prototype.showModules=function(){this.toggleModule=!this.toggleModule},t.prototype.deleteModule=function(t){this.selectModules.splice(t,1)},t.prototype.cancel=function(){this.resetIds(),this.modal.dismiss()},t.prototype.send=function(t){t.stopPropagation(),t.preventDefault();var e=this,s={};e.selectModules&&e.selectModules.length>0?(s.infoIds=e.getOfferIds(e.selectModules),s.type=e.type,e.pauseId?(s.pauseId=e.pauseId,e.request.doPost({url:\"addPause\",data:s,success:function(t){t&&200==t.code?(e.warn.onSuccess(t.msg||i.a.SUCCESS.DATA),e.resetIds(),e.modal.close(t)):e.warn.onError(t.msg||i.a.FAIL.DATA)}})):(s.id=e.id,e.request.doPost({url:\"addBasicQuote\",data:s,success:function(t){t&&200==t.code?(e.setCookie(),e.warn.onSuccess(t.msg||i.a.SUCCESS.DATA),e.resetIds(),e.modal.close(JSON.stringify(t.data[0]))):e.warn.onError(t.msg||i.a.FAIL.DATA)}}))):e.warn.onWarn(i.a.SELECT_NOT_EMPTY)},t.prototype.getOfferIds=function(t){var e=[];if(t&&t.length>0)for(var s=0,i=t;s<i.length;s++)e.push(i[s].id);return e},t.prototype.sendTo=function(t){t.stopPropagation(),t.preventDefault(),this.selectModules&&this.selectModules.length>0?(this.setCookie(),this.modal.close(JSON.stringify(this.selectModules))):this.warn.onWarn(i.a.SELECT_NOT_EMPTY)},t.prototype.resetIds=function(){this.selectModuleIds=[],this.selectModules=[],this.pageNo=o.a.PAGE.PAGE_NO,this.projectName=\"\",this.category=\"\",this.clickSelectAll=!1,this.loadAll=!1},t.prototype.selectModuleAll=function(){this.clickSelectAll=!this.clickSelectAll;var t={pageNo:o.a.PAGE.PAGE_NO,pageSize:this.total?this.total:o.a.PAGE.PAGE_SIZE,category:this.category,projectName:this.projectName,companyId:this.user.getCompanyId(),versionType:this.getSelectType()};this.versionId>0&&(t.versionId=this.versionId),this.total!=this.makes.getMarkings().length?this.loadModuleAll(t):this.loadAll&&this.clickSelectAll?(this.loadAll=!1,this.loadModuleAll(t)):this.clickSelectAll?this.moduleAll(this.makes.getMarkings()):this.moduleRemoveAll(this.makes.getMarkings())},t.prototype.loadModuleAll=function(t){var e=this;e.request.doPost({url:\"moduleListQuote\",data:t,success:function(t){t&&200==t.code?t.data&&t.data.pageSet&&(e.makes.setMarking(t.data.pageSet),e.moduleAll(t.data.pageSet)):e.warn.onError(t.msg||i.a.FAIL.DATA)}})},t.prototype.moduleAll=function(t){if(t&&t.length>0)for(var e=0,s=t;e<s.length;e++){var i=s[e];i.num=1,this.selectModules.push(i)}},t.prototype.moduleRemoveAll=function(t){if(t&&t.length>0){for(var e=t.length,s=this.selectModules.length,i=!0,o=0;o<e;o++){i=!0;for(var n=0;n<s;n++)this.selectModules[n].id===t[o].id&&i&&(this.selectModules.splice(n,1,\"\"),i=!1)}this.selectModules=this.sortModuleAll(this.selectModules)}},t.prototype.sortModuleAll=function(t){var e=[];if(t&&t.length>0)for(var s=0;s<t.length;s++)t[s]&&e.push(t[s]);return e},t.prototype.getName=function(){var t=\"\";if(this.configBase&&this.configBase&&this.configBase.length>0)for(var e=0,s=this.configBase;e<s.length;e++){var i=s[e];if(this.versionId&&!t&&i.versions&&i.versions.length>0)for(var o=0,n=i.versions;o<n.length;o++){var a=n[o];a.versionId===Number(this.versionId)&&(t=a.name)}}return t||\"\\u7248\\u672c\\u540d\\u79f0\"},t.prototype.getSelectType=function(){return Object(n.x)(this.type)},t.prototype.setCookie=function(){this.cookie.set(\"basic\"+this.type,JSON.stringify({versionId:this.versionId,category:this.category,projectName:this.projectName}))},t.prototype.ngOnDestroy=function(){this.resetIds(),this.config.setConfigBase(null)},t}())},iNCl:function(t,e,s){\"use strict\";s.d(e,\"a\",function(){return a});var i=s(\"OHOg\"),o=s(\"5aMp\"),n=s(\"CcnG\"),a=function(){function t(t,e){this.req=t,this.warn=e,this.makings=[],this.showMakes=[]}return t.prototype.getMarkings=function(){return this.makings},t.prototype.addMakings=function(t){if(this.makings&&0===this.makings.length)for(var e=0,s=t;e<s.length;e++)(n=s[e]).num=1,this.makings.push(n);if(this.makings&&this.makings.length>0)for(var i=0,o=t;i<o.length;i++){var n;(n=o[i]).num=1,this.existMakingById(n.id)||this.makings.push(n)}},t.prototype.setMarking=function(t){if(this.makings=[],t&&t.length>0)for(var e=0,s=t;e<s.length;e++){var i=s[e];i.num=1,this.makings.push(i)}},t.prototype.existMakingById=function(t){if(this.makings&&this.makings.length>0)for(var e=0,s=this.makings;e<s.length;e++)if(s[e].id===t)return!0;return!1},t.prototype.resetMakingRemark=function(){this.makings&&this.makings.length>0&&this.makings.forEach(function(t){t.remark=\"\"})},t.prototype.findMaterialByAll=function(t,e){if(this.makings&&this.makings.length>0){for(var s=[],i=0,o=this.makings;i<o.length;i++){var n=o[i];n.versionId==t&&s.push(n)}return s.length===e}return!1},t.ngInjectableDef=n.W({factory:function(){return new t(n.Aa(i.a),n.Aa(o.a))},token:t,providedIn:\"root\"}),t}()},l5zS:function(t,e,s){\"use strict\";s.d(e,\"a\",function(){return i});var i=function(){function t(t){this.modal=t}return t.prototype.ngOnInit=function(){console.log(this.type),console.log(this.versionId),console.log(this.versionType)},t.prototype.cancel=function(){this.modal.dismiss()},t.prototype.getType=function(){switch(this.type){case 2:return 2;case 3:return 3;case 5:return 5;default:return 1}},t.prototype.getTitle=function(t){switch(t){case 4:return\"\\u6dfb\\u52a0\\u5176\\u5b83\\u9879\\u76ee\";case 5:return\"\\u9009\\u62e9\\u6750\\u6599\\u6e05\\u5355\";default:return\"\\u9009\\u62e9\\u88c5\\u4fee\\u7c7b\\u578b\"}},t.prototype.visibleHandler=function(t){this.modal.dismiss()},t.prototype.successHandler=function(t){this.modal.close(t)},t}()},oRWq:function(t,e,s){\"use strict\";s.d(e,\"a\",function(){return a}),s(\"5aMp\");var i=s(\"f8yE\"),o=(s(\"OHOg\"),s(\"WPLi\"),s(\"t/Na\")),n=s(\"lcOY\"),a=function(){function t(t,e,s,i){this.activeModal=t,this.warn=e,this.req=s,this.qn=i,this.fileList=[],this.images=[],this.loading=!1}return t.prototype.ngOnInit=function(){var t=this;this.qn.getToken()||this.req.doPostImg({url:\"token\",success:function(e){if(e&&200==e.code){var s=JSON.parse(e.data).uptoken,o=JSON.parse(e.data).url;t.qn.setToken(s),t.qn.setDataUrl(o)}else t.warn.onError(e.msg||i.a.FAIL.DATA)}}),this.total||(this.total=n.a.UPLOAD.MAX_NUM),this.num||(this.num=0),this.open||(this.open=!1)},t.prototype.change=function(t){if(t.target.files.length>=n.a.UPLOAD.MAX_NUM)this.warn.onWarn(i.a.ERROR.UPLOAD_IMG_MAX);else{if(t.target.files&&t.target.files.length<n.a.UPLOAD.MAX_NUM){for(var e=t.target.files,s=0;s<e.length;s++)Number(this.coverSize(e[s].size))>n.a.UPLOAD.MAX_SIZE?this.warn.onWarn(e[s].name+\",\\u6587\\u4ef6\\u8d85\\u8fc710M\\uff0c\\u65e0\\u6cd5\\u4e0a\\u4f20\"):(e[s].cid=this.cid,e[s].progress=0,e[s].show=!0,e[s].success=!1,e[s].uploadString=this.split,this.fileList.push(e[s]));if(this.qn.getToken()&&!this.loading){var o=0;for(s=0;s<this.fileList.length;s++)if(!this.fileList[s].success){o=s;break}this.uploadFile(this.fileList,o,this.qn.getToken())}}t.target.value=\"\"}},t.prototype.changeFile=function(t){if(t.target.files.length>=n.a.UPLOAD.MAX_NUM)this.warn.onWarn(i.a.ERROR.UPLOAD_IMG_MAX);else if(t.target.files.length+this.num+this.computedFileShow(this.fileList)>n.a.UPLOAD.MAX_NUM)this.warn.onWarn(i.a.ERROR.IMG_MAX);else{if(t.target.files&&t.target.files.length<n.a.UPLOAD.MAX_NUM){for(var e=t.target.files,s=0;s<e.length;s++)Number(this.coverSize(e[s].size))>n.a.UPLOAD.MAX_SIZE?this.warn.onWarn(e[s].name+\",\\u6587\\u4ef6\\u8d85\\u8fc710M\\uff0c\\u65e0\\u6cd5\\u4e0a\\u4f20\"):(e[s].cid=this.cid,e[s].progress=0,e[s].show=!0,e[s].success=!1,e[s].uploadString=this.split,this.fileList.push(e[s]));if(this.qn.getToken()&&!this.loading){var o=0;for(s=0;s<this.fileList.length;s++)if(!this.fileList[s].success){o=s;break}this.uploadFile(this.fileList,o,this.qn.getToken())}}t.target.value=\"\"}},t.prototype.uploadFile=function(t,e,s){var i=this;e>=t.length||(t[e].success?this.uploadFile(t,++e,s):t[e].request=this.qn.postFile(t[e],s).subscribe(function(n){n.type===o.f.UploadProgress?(i.loading=!0,t[e].progress=Math.round(100*n.loaded/n.total)):n instanceof o.k&&(i.loading=!1,t[e].success=!0,t[e].src=i.qn.getDataUrl()+\"/\"+n.body.key,i.images.push(t[e].src),i.uploadFile(t,++e,s))}))},t.prototype.deleteImage=function(t,e){if(t.stopPropagation(),t.preventDefault(),e&&this.images.length>0){if(this.images.indexOf(e)>-1)for(var s=0;s<this.images.length;s++)this.images[s]===e&&this.images.splice(s,1);if(this.fileList&&this.fileList.length>0)for(s=0;s<this.fileList.length;s++)this.fileList[s].src&&this.fileList[s].src===e&&(this.fileList[s].show=!1)}},t.prototype.removeImage=function(t,e){t.stopPropagation(),t.preventDefault(),this.fileList[e].request&&(this.fileList[e].request.unsubscribe(),this.loading=!1),this.fileList.splice(e,1),this.loading||this.uploadFile(this.fileList,e,this.qn.getToken())},t.prototype.coverSize=function(t){return Number(t/1e3/1024).toFixed(2)},t.prototype.clickImage=function(){this.images&&this.images.length>0?this.activeModal.close(this.images):this.warn.onWarn(i.a.UPLOAD.EMPTY)},t.prototype.computedFileShow=function(t){var e=0;if(t&&t.length>0)for(var s=0,i=t;s<i.length;s++)i[s].show&&e++;return e},t.prototype.ngOnDestroy=function(){this.num=null,this.total=null,this.open=!1},t}()},wR29:function(t,e,s){\"use strict\";s.d(e,\"a\",function(){return l});var i=s(\"gIcY\"),o=s(\"EJak\"),n=(s(\"OHOg\"),s(\"5aMp\"),s(\"f8yE\")),a=(s(\"LWby\"),s(\"Xm+O\")),r=s(\"FoyA\"),l=function(){function t(t,e,s,i,o,n){this.modal=t,this.fb=e,this.req=s,this.warn=i,this.config=o,this.modalService=n,this.isEdit=!1}return t.prototype.ngOnInit=function(){if(2===this.type||3===this.type||5===this.type)this.selectType=this.getSelectType(),this.itemForm=this.fb.group({versionType:[{value:this.selectType,disabled:!0},[i.x.required]],versionId:[this.selectVersionId,[i.x.required]]});else if(1===this.type)this.selectType||(this.selectType=2,this.changeChildOptions()),this.itemForm=this.fb.group({versionType:[this.selectType,[i.x.required]],versionId:[this.selectVersionId,[i.x.required]]}),this.versionId&&this.versionType&&(this.selectType=this.versionType,this.selectVersionId=this.versionId,this.save());else if(this.getOtherByState(this.type,this.aid)){if(this.content){var t=this.content;this.isEdit=!0,this.name=t.name,this.num=t.num,this.univalent=t.univalent,this.discountPrice=t.totalPrice?t.totalPrice:\"0\",this.offerExplain=t.offerExplain}this.itemForm=this.fb.group({name:[this.name,[i.x.required,i.x.minLength(1),i.x.maxLength(100)]],num:[this.num,[i.x.required,i.x.minLength(1),i.x.maxLength(10),o.m]],univalent:[this.univalent,[i.x.required,i.x.minLength(1),i.x.maxLength(10),o.k]],discountPrice:[this.discountPrice,[i.x.required,i.x.minLength(1),i.x.maxLength(10),o.m]],offerExplain:[this.offerExplain,[i.x.maxLength(500)]]})}this.getOtherByState(this.type,this.aid)||this.config.loadConfig(this.id)},t.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){if(!t.getOtherByState(t.type,t.aid)&&t.configBase&&t.configBase&&t.configBase.length>0)for(var e=0,s=t.configBase;e<s.length;e++){var i=s[e];t.selectType&&i.type==t.selectType&&(t.changeOptions=i.versions,t.changeOptions&&t.changeOptions.length>0&&(t.selectVersionId=t.versionId?t.versionId:t.changeOptions[0].versionId))}},1500)},t.prototype.ngDoCheck=function(){this.getOtherByState(this.type,this.aid)||(this.configBase=this.config.getConfigBase())},t.prototype.fillCount=function(){if(this.itemForm.get(\"univalent\")&&this.itemForm.get(\"num\")){var t=this.itemForm.get(\"univalent\").valid?this.itemForm.get(\"univalent\").value:\"\",e=this.itemForm.get(\"num\").valid?this.itemForm.get(\"num\").value:\"\",s=String(this.changeToInt(t,2)*this.changeToInt(e,2)/1e4);s=s.lastIndexOf(\".\")>0?s.substring(0,s.lastIndexOf(\".\")+3):s,this.itemForm.get(\"discountPrice\").setValue(s)}},t.prototype.changeToInt=function(t,e){return Object(r.T)(t,e)},t.prototype.cancel=function(){this.modal.dismiss()},t.prototype.submit=function(){var t=this;if(console.log(t.itemForm),t.itemForm.valid){var e=t.itemForm.value;e.id=this.isEdit?t.content.id:t.id,e.num=Number(e.num),e.univalent=Number(e.univalent),e.discountPrice=Number(e.discountPrice),t.req.doPost({url:t.isEdit?\"upOtherQuote\":\"addOtherQuote\",data:e,success:function(e){e&&200==e.code?(t.warn.onSuccess(e.msg||n.a.SUCCESS.DATA),t.modal.close(JSON.stringify(e.data[0]))):t.warn.onError(e.data?e.data:e.msg||n.a.FAIL.DATA)}})}},t.prototype.modify=function(){var t=this;if(this.aid&&this.itemForm.valid){var e=this.itemForm.value;e.totalPrice=Number(e.discountPrice),delete e.discountPrice,e.id=this.aid,e.num=Number(e.num),e.univalent=Number(e.univalent),this.req.doPost({url:\"otherPause\",data:e,success:function(e){t.modal.close(e)}})}},t.prototype.save=function(){var t=this;if(t.itemForm.valid){var e=t.itemForm.value;e.id=t.id,e.type=t.getType(),e.versionType=t.selectType,t.selectVersionId=e.versionId,1!=t.type?t.req.doPost({url:\"choiceVersion\",data:e,success:function(e){if(e&&200==e.code){var s=t.modalService.open(a.a,{centered:!0,keyboard:!0,backdrop:\"static\",size:\"lg\"});s.componentInstance.versionId=t.selectVersionId,s.componentInstance.type=t.getType(),s.componentInstance.offerId=t.id,s.componentInstance.infoName=t.branchName,s.componentInstance.pauseId=t.aid,s.result.then(function(e){t.modal.close(JSON.stringify(e))},function(e){console.log(e),t.modal.dismiss()})}else t.warn.onError(e.msg||n.a.FAIL.DATA)}}):t.modal.close(JSON.stringify(t.itemForm.value))}},t.prototype.changeItem=function(){var t=this;if(t.itemForm.valid){var e=t.itemForm.value;if(e.id=t.id,e.type=t.getType(),e.versionType=t.selectType,t.selectVersionId=e.versionId,1!=t.type){var s=t.modalService.open(a.a,{centered:!0,keyboard:!0,backdrop:\"static\",size:\"lg\"});s.componentInstance.versionId=t.selectVersionId,s.componentInstance.type=t.getType(),s.componentInstance.offerId=t.id,s.componentInstance.infoName=t.branchName,s.componentInstance.pauseId=t.aid,s.result.then(function(e){t.modal.close(JSON.stringify(e))},function(e){t.modal.dismiss()})}}else t.modal.close(JSON.stringify(t.itemForm.value))},t.prototype.store=function(){this.itemForm.valid&&this.modal.close(JSON.stringify(this.itemForm.value))},t.prototype.changeChildOptions=function(){if(this.configBase&&this.configBase.length>0)for(var t=0,e=this.configBase;t<e.length;t++){var s=e[t];this.selectType&&s.type==this.selectType&&(this.changeOptions=s.versions,this.changeOptions&&this.changeOptions.length>0&&(this.selectVersionId=this.changeOptions[0].versionId))}},t.prototype.getTitle=function(t){switch(t){case 4:return\"\\u5176\\u5b83\\u9879\\u76ee\";case 5:return\"\\u9009\\u62e9\\u6750\\u6599\\u6e05\\u5355\";default:return\"\\u9009\\u62e9\\u88c5\\u4fee\\u7c7b\\u578b\"}},t.prototype.getType=function(){switch(this.type){case 2:return 2;case 3:return 3;case 5:return 5;default:return 1}},t.prototype.getSelectType=function(){return Object(r.x)(this.type)},t.prototype.visibleHandler=function(t){this.type=t.type,this.selectType=this.getSelectType(),this.selectVersionId=t.versionId,1===this.selectType&&this.modal.dismiss()},t.prototype.successHandler=function(t){t&&this.modal.close(t)},t.prototype.getOtherByState=function(t,e){return 4===t&&\"undefined\"!=e},t.prototype.ngOnDestroy=function(){this.config.setConfigBase(null)},t}()}}]);","extractedComments":[]}