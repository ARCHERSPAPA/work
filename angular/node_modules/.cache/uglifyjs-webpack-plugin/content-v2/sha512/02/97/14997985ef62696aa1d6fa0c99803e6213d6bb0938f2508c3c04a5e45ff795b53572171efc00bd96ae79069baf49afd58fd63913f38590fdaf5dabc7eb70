{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{\"Xm+O\":function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return a}),i(\"OHOg\"),i(\"5aMp\");var s=i(\"lcOY\"),o=i(\"f8yE\"),n=(i(\"iNCl\"),i(\"LWby\"),i(\"Ouoq\"),i(\"FoyA\")),a=function(){function t(t,e,i,o,n,a){this.request=t,this.warn=e,this.makes=i,this.modal=o,this.config=n,this.user=a,this.pageNo=s.a.PAGE.PAGE_NO,this.pageSize=s.a.PAGE.PAGE_SIZE,this.total=s.a.PAGE.PAGE_TOTAL,this.category=\"\",this.projectName=\"\",this.selectModuleIds=[],this.selectModules=[],this.selectModulesAll=!1}return t.prototype.ngOnInit=function(){this.changeData(),this.loadCategory()},t.prototype.changeData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;t&&t.length>0&&(this.pageNo=s.a.PAGE.PAGE_NO,this.total=s.a.PAGE.PAGE_TOTAL),i.versionId&&i.request.doPost({url:\"moduleListQuote\",data:{versionId:i.versionId,pageNo:i.pageNo,pageSize:i.pageSize,category:i.category,projectName:i.projectName,companyId:i.user.getCompanyId(),versionType:Object(n.x)(i.type)},success:function(t){t&&200==t.code?(i.moduleList=t.data.pageSet,i.total=t.data.total,i.makes.addMakings(i.moduleList)):i.warn.onError(t.msg||o.a.FAIL.DATA)}})},t.prototype.ngDoCheck=function(){this.config.getConfigBase()&&!this.configBase?this.configBase=this.config.getConfigBase():this.title=this.title?this.title:this.getName()},t.prototype.loadCategory=function(){var t=this;t.request.doPost({url:\"categoryList\",data:{versionId:t.versionId},success:function(e){e&&200===e.code?t.categoryList=e.data:t.warn.onError(e.msg||o.a.FAIL.DATA)}})},t.prototype.selectModule=function(t){this.existModuleId(t.id)?this.selectModuleIds.splice(this.selectModuleIds.indexOf(t.id),1):this.selectModuleIds.push(t.id)},t.prototype.existModuleId=function(t){var e=this.selectModuleIds;if(e&&e.length>0)for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1},t.prototype.existModuleById=function(t){var e=this.selectModules;if(e&&e.length>0)for(var i=0,s=e;i<s.length;i++)if(s[i].id==t)return!0},t.prototype.findModuleById=function(t){return 0},t.prototype.cancel=function(){this.resetIds(),this.modal.dismiss({type:this.type,versionId:this.versionId})},t.prototype.send=function(){var t=this,e={};t.selectModuleIds.length>0?(e.infoIds=t.selectModuleIds,3===t.type||2===t.type||5===t.type?e.type=t.type:(e.type=1,e.infoBranchName=t.infoName?t.infoName:\"\"),t.pauseId?(e.pauseId=t.pauseId,t.request.doPost({url:\"addPause\",data:e,success:function(e){e&&200==e.code?(t.warn.onSuccess(e.msg||o.a.SUCCESS.DATA),t.resetIds(),t.modal.close(e)):t.warn.onError(e.msg||o.a.FAIL.DATA)}})):(e.id=t.offerId,t.request.doPost({url:\"addBasicQuote\",data:e,success:function(e){e&&200==e.code?(t.warn.onSuccess(e.msg||o.a.SUCCESS.DATA),t.resetIds(),t.modal.close(JSON.stringify(e.data[0]))):t.warn.onError(e.msg||o.a.FAIL.DATA)}}))):t.warn.onWarn(o.a.SELECT_NOT_EMPTY)},t.prototype.sendTo=function(){if(5===this.type){var t=this.makes.getMarkings(),e=[];if(this.selectModuleIds&&this.selectModuleIds.length>0&&t.length>0)for(var i=0;i<this.selectModuleIds.length;i++)for(var s=0,o=t;s<o.length;s++){var n=o[s];this.selectModuleIds[i]===n.id&&(n.remark=\"\",e.push(n))}this.modal.close({modules:e,versionId:this.versionId,category:this.category,projectName:this.projectName})}},t.prototype.resetIds=function(){this.selectModuleIds=[],this.pageNo=s.a.PAGE.PAGE_NO,this.projectName=\"\",this.category=\"\"},t.prototype.selectModuleAll=function(){var t=this,e=this;e.versionId?e.request.doPost({url:\"moduleFoldIds\",data:{versionId:e.versionId,category:e.category,projectName:e.projectName,companyId:e.user.getCompanyId(),versionType:e.type},success:function(i){i&&200==i.code?e.request.doPost({url:\"moduleListQuote\",data:{versionId:e.versionId,pageNo:e.pageNo,pageSize:i.data.length?i.data.length:s.a.PAGE.PAGE_SIZE,category:e.category,projectName:e.projectName},success:function(i){i&&200==i.code?i.data&&i.data.pageSet&&(e.selectModules.push(i.data.pageSet),e.makes.addMakings(i.data.pageSet)):t.warn.onError(i.msg||o.a.FAIL.DATA)}}):e.warn.onError(i.msg||o.a.FAIL.DATA)}}):this.selectModuleIds=[]},t.prototype.getName=function(){var t=\"\";if(this.configBase&&this.configBase&&this.configBase.length>0)for(var e=0,i=this.configBase;e<i.length;e++){var s=i[e];if(this.versionId&&!t&&s.versions&&s.versions.length>0)for(var o=0,n=s.versions;o<n.length;o++){var a=n[o];a.versionId===Number(this.versionId)&&(t=a.name)}}return t||\"\\u7248\\u672c\\u540d\\u79f0\"},t}()},XsMc:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return s});var s=function(){function t(t){this.activeModal=t,this.cancelIds=[]}return t.prototype.ngOnInit=function(){this.title=\"\\u8bf7\\u52fe\\u9009\\u9700\\u8981\\u8ba1\\u7b97\\u5de5\\u7a0b\\u7ba1\\u7406\\u8d39\\u7684\\u9879\\u76ee\"},t.prototype.getTotal=function(t,e){var i=0,s=this.getInfoByType(t);if(s&&s.length>0)for(var o=0,n=s;o<n.length;o++){var a=n[o];a.engineerYn===e&&(i+=Number(a.totalPrice))}return Number(100*i/100)},t.prototype.getInfoByType=function(t){var e=[];if(this.data&&this.data.length>0)for(var i=0,s=this.data;i<s.length;i++){var o=s[i];if(o.type===t){e=o.infos;break}}return e},t.prototype.getTotalSeries=function(){var t=0;if(this.data&&this.data.length>0)for(var e=0,i=this.data;e<i.length;e++){var s=i[e];if(1===s.type&&2===s.versionType){if(s.infoMaps&&s.infoMaps.length>0)for(var o=0,n=s.infoMaps;o<n.length;o++){var a=n[o];if(a.infos&&a.infos.length>0)for(var r=0,l=a.infos;r<l.length;r++)t+=Number(l[r].totalPrice)}}else 1===s.type&&2!==s.versionType&&(t=s.smallTotal)}return Number(100*t/100)},t.prototype.toggleCheck=function(t){var e=0;if(t&&t.length>0){for(var i=0,s=t;i<s.length;i++)s[i].engineerYn&&e++;return t.length===e}return!1},t.prototype.getTotalChecked=function(){var t,e=0;return e+=Number(this.getTotal(2,!0)),e+=Number(this.getTotal(3,!0)),e+=Number(this.getTotal(4,!0)),e+=Number(this.getTotalSeries()),(t=String(e*this.radio*100/100)).lastIndexOf(\".\")>0?t.substring(0,t.lastIndexOf(\".\")+3):t},t.prototype.getTotalUnchecked=function(){var t,e=0;return e+=Number(this.getTotal(2,!1)),e+=Number(this.getTotal(3,!1)),e+=Number(this.getTotal(4,!1)),(t=String(100*e/100)).lastIndexOf(\".\")>0?t.substring(0,t.lastIndexOf(\".\")+3):t},t.prototype.toggleInfo=function(t){t.engineerYn=!t.engineerYn,this.setCancelId(t.id)},t.prototype.toggleAll=function(t,e){var i=this;t&&t.length&&t.forEach(function(t){t.engineerYn=!e,t.engineerYn?i.removeCancelId(t.id):i.addCancelId(t.id)})},t.prototype.setCancelId=function(t){if(0==this.cancelIds.length)this.cancelIds.push(t);else if(-1==this.cancelIds.indexOf(t))this.cancelIds.push(t);else for(var e=0;e<this.cancelIds.length;e++)this.cancelIds[e]===t&&this.cancelIds.splice(e,1)},t.prototype.removeCancelId=function(t){if(this.cancelIds&&this.cancelIds.length>0)for(var e=0;e<this.cancelIds.length;e++)this.cancelIds[e]===t&&this.cancelIds.splice(e,1)},t.prototype.addCancelId=function(t){0==this.cancelIds.length&&this.cancelIds.push(t),this.cancelIds&&this.cancelIds.length>0&&-1==this.cancelIds.indexOf(t)&&this.cancelIds.push(t)},t.prototype.ok=function(){var t=[];this.data&&this.data.length>0&&this.data.forEach(function(e){2!==e.type&&3!==e.type&&4!==e.type||e.infos&&e.infos.length>0&&e.infos.forEach(function(e){e.engineerYn||t.push(e.id)})}),this.activeModal.close(t)},t}()},c0u4:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return a}),i(\"OHOg\"),i(\"LWby\");var s=i(\"f8yE\"),o=(i(\"5aMp\"),i(\"iNCl\"),i(\"lcOY\")),n=i(\"FoyA\"),a=(i(\"Ouoq\"),i(\"JQBr\"),function(){function t(t,e,i,s,n,a,r,l){this.request=t,this.warn=e,this.makes=i,this.modal=s,this.config=n,this.user=a,this.el=r,this.cookie=l,this.pageNo=o.a.PAGE.PAGE_NO,this.pageSize=o.a.PAGE.PAGE_SIZE,this.total=o.a.PAGE.PAGE_TOTAL,this.category=\"\",this.projectName=\"\",this.versionId=-1,this.selectModuleIds=[],this.selectModules=[],this.toggleModule=!1,this.balls=[{show:!1},{show:!1},{show:!1},{show:!1}],this.loadAll=!1,this.clickSelectAll=!1}return t.prototype.ngOnInit=function(){if(this.config.getConfigBase()||this.config.loadConfig(this.id),this.cookie.get(\"basic\"+this.type)){var t=JSON.parse(this.cookie.get(\"basic\"+this.type));this.versionId=t.versionId,this.versionId>0&&(this.loadCategory(),this.category=t.category),this.projectName=t.projectName}this.changeData()},t.prototype.changeChildOptions=function(){if(this.configBase&&this.configBase.length>0)for(var t=0,e=this.configBase;t<e.length;t++){var i=e[t];this.getSelectType()&&i.type==this.getSelectType()&&(this.changeOptions=i.versions)}},t.prototype.changeVersion=function(){this.pageNo=o.a.PAGE.PAGE_NO,this.projectName=\"\",this.category=\"\",this.toggleModule=!1,this.versionId>0?(this.loadCategory(),this.clickSelectAll=!1):(this.categoryList=[],this.moduleList=[]),this.changeData()},t.prototype.changeData=function(){var t=this,e={pageNo:t.pageNo,pageSize:t.pageSize,category:t.category,projectName:t.projectName,companyId:t.user.getCompanyId(),versionType:t.getSelectType()};t.versionId>0&&(e.versionId=t.versionId),t.request.doPost({url:\"moduleListQuote\",data:e,success:function(e){e&&200==e.code?(t.moduleList=e.data.pageSet,t.total=e.data.total):t.warn.onError(e.msg||s.a.FAIL.DATA)}})},t.prototype.ngDoCheck=function(){this.config.getConfigBase()&&!this.configBase&&(this.configBase=this.config.getConfigBase(),this.changeChildOptions()),this.switch=this.toggleModule?\"down\":\"up\"},t.prototype.searchData=function(){this.pageNo=o.a.PAGE.PAGE_NO,this.total=o.a.PAGE.PAGE_TOTAL,this.selectModuleIds=[],this.toggleModule=!1,this.changeData(),this.loadAll=!0,this.clickSelectAll=!1},t.prototype.loadCategory=function(){var t=this;t.versionId>0&&t.request.doPost({url:\"categoryList\",data:{versionId:t.versionId},success:function(e){e&&200===e.code?t.categoryList=e.data:t.warn.onError(e.msg||s.a.FAIL.DATA)}})},t.prototype.selectModule=function(t,e){for(var i,s=this,o=t.target,n=this.el.nativeElement.querySelectorAll(\".ball\"),a=this.el.nativeElement.querySelector(\".item-content\"),r={x:o.offsetLeft+o.offsetWidth/2,y:o.offsetTop+o.offsetHeight/2-a.scrollTop},l=this.getEndPoint(),h=l.x-240,c=((r.y-l.y)*(r.x-h)-(r.y-(l.y-40))*(r.x-l.x))/((r.x*r.x-l.x*l.x)*(r.x-h)-(r.x*r.x-h*h)*(r.x-l.x)),u=(l.y-r.y-c*(l.x*l.x-r.x*r.x))/(l.x-r.x),d=r.y-c*r.x*r.x-u*r.x,g=-1,p=0;p<s.balls.length;p++)if(!s.balls[p].show){s.balls[p].show=!0,i=n[p],(g=p)>=s.balls.length-1&&s.balls.push({show:!1});break}var f=r.x,m=r.y;i.style.left=f+\"px\",i.style.top=m+\"px\";var y=setInterval(function(){f<l.x?(i.style.left=(f+=10*(g+1))+\"px\",i.style.top=c*f*f+u*f+d+\"px\"):(e.num=1,s.selectModules.push(e),clearInterval(y),i.style=null,s.balls[g].show=!1)},5*(g+1))},t.prototype.getEndPoint=function(){var t=this.el.nativeElement.querySelector(\"#count\");return{x:t.offsetLeft+t.offsetWidth,y:t.offsetTop+t.offsetHeight/2+70}},t.prototype.showModules=function(){this.toggleModule=!this.toggleModule},t.prototype.deleteModule=function(t){this.selectModules.splice(t,1)},t.prototype.cancel=function(){this.resetIds(),this.modal.dismiss()},t.prototype.send=function(t){t.stopPropagation(),t.preventDefault();var e=this,i={};e.selectModules&&e.selectModules.length>0?(i.infoIds=e.getOfferIds(e.selectModules),i.type=e.type,e.pauseId?(i.pauseId=e.pauseId,e.request.doPost({url:\"addPause\",data:i,success:function(t){t&&200==t.code?(e.warn.onSuccess(t.msg||s.a.SUCCESS.DATA),e.resetIds(),e.modal.close(t)):e.warn.onError(t.msg||s.a.FAIL.DATA)}})):(i.id=e.id,e.request.doPost({url:\"addBasicQuote\",data:i,success:function(t){t&&200==t.code?(e.setCookie(),e.warn.onSuccess(t.msg||s.a.SUCCESS.DATA),e.resetIds(),e.modal.close(JSON.stringify(t.data[0]))):e.warn.onError(t.msg||s.a.FAIL.DATA)}}))):e.warn.onWarn(s.a.SELECT_NOT_EMPTY)},t.prototype.getOfferIds=function(t){var e=[];if(t&&t.length>0)for(var i=0,s=t;i<s.length;i++)e.push(s[i].id);return e},t.prototype.sendTo=function(t){t.stopPropagation(),t.preventDefault(),this.selectModules&&this.selectModules.length>0?(this.setCookie(),this.modal.close(JSON.stringify(this.selectModules))):this.warn.onWarn(s.a.SELECT_NOT_EMPTY)},t.prototype.resetIds=function(){this.selectModuleIds=[],this.selectModules=[],this.pageNo=o.a.PAGE.PAGE_NO,this.projectName=\"\",this.category=\"\",this.clickSelectAll=!1,this.loadAll=!1},t.prototype.selectModuleAll=function(){this.clickSelectAll=!this.clickSelectAll;var t={pageNo:o.a.PAGE.PAGE_NO,pageSize:this.total?this.total:o.a.PAGE.PAGE_SIZE,category:this.category,projectName:this.projectName,companyId:this.user.getCompanyId(),versionType:this.getSelectType()};this.versionId>0&&(t.versionId=this.versionId),this.total!=this.makes.getMarkings().length?this.loadModuleAll(t):this.loadAll&&this.clickSelectAll?(this.loadAll=!1,this.loadModuleAll(t)):this.clickSelectAll?this.moduleAll(this.makes.getMarkings()):this.moduleRemoveAll(this.makes.getMarkings())},t.prototype.loadModuleAll=function(t){var e=this;e.request.doPost({url:\"moduleListQuote\",data:t,success:function(t){t&&200==t.code?t.data&&t.data.pageSet&&(e.makes.setMarking(t.data.pageSet),e.moduleAll(t.data.pageSet)):e.warn.onError(t.msg||s.a.FAIL.DATA)}})},t.prototype.moduleAll=function(t){if(t&&t.length>0)for(var e=0,i=t;e<i.length;e++){var s=i[e];s.num=1,this.selectModules.push(s)}},t.prototype.moduleRemoveAll=function(t){if(t&&t.length>0){for(var e=t.length,i=this.selectModules.length,s=!0,o=0;o<e;o++){s=!0;for(var n=0;n<i;n++)this.selectModules[n].id===t[o].id&&s&&(this.selectModules.splice(n,1,\"\"),s=!1)}this.selectModules=this.sortModuleAll(this.selectModules)}},t.prototype.sortModuleAll=function(t){var e=[];if(t&&t.length>0)for(var i=0;i<t.length;i++)t[i]&&e.push(t[i]);return e},t.prototype.getName=function(){var t=\"\";if(this.configBase&&this.configBase&&this.configBase.length>0)for(var e=0,i=this.configBase;e<i.length;e++){var s=i[e];if(this.versionId&&!t&&s.versions&&s.versions.length>0)for(var o=0,n=s.versions;o<n.length;o++){var a=n[o];a.versionId===Number(this.versionId)&&(t=a.name)}}return t||\"\\u7248\\u672c\\u540d\\u79f0\"},t.prototype.getSelectType=function(){return Object(n.x)(this.type)},t.prototype.setCookie=function(){this.cookie.set(\"basic\"+this.type,JSON.stringify({versionId:this.versionId,category:this.category,projectName:this.projectName}))},t.prototype.ngOnDestroy=function(){this.resetIds(),this.config.setConfigBase(null)},t}())},iNCl:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return a});var s=i(\"OHOg\"),o=i(\"5aMp\"),n=i(\"CcnG\"),a=function(){function t(t,e){this.req=t,this.warn=e,this.makings=[],this.showMakes=[]}return t.prototype.getMarkings=function(){return this.makings},t.prototype.addMakings=function(t){if(this.makings&&0===this.makings.length)for(var e=0,i=t;e<i.length;e++)(n=i[e]).num=1,this.makings.push(n);if(this.makings&&this.makings.length>0)for(var s=0,o=t;s<o.length;s++){var n;(n=o[s]).num=1,this.existMakingById(n.id)||this.makings.push(n)}},t.prototype.setMarking=function(t){if(this.makings=[],t&&t.length>0)for(var e=0,i=t;e<i.length;e++){var s=i[e];s.num=1,this.makings.push(s)}},t.prototype.existMakingById=function(t){if(this.makings&&this.makings.length>0)for(var e=0,i=this.makings;e<i.length;e++)if(i[e].id===t)return!0;return!1},t.prototype.resetMakingRemark=function(){this.makings&&this.makings.length>0&&this.makings.forEach(function(t){t.remark=\"\"})},t.prototype.findMaterialByAll=function(t,e){if(this.makings&&this.makings.length>0){for(var i=[],s=0,o=this.makings;s<o.length;s++){var n=o[s];n.versionId==t&&i.push(n)}return i.length===e}return!1},t.ngInjectableDef=n.W({factory:function(){return new t(n.Aa(s.a),n.Aa(o.a))},token:t,providedIn:\"root\"}),t}()},l5zS:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return s});var s=function(){function t(t){this.modal=t}return t.prototype.ngOnInit=function(){console.log(this.type),console.log(this.versionId),console.log(this.versionType)},t.prototype.cancel=function(){this.modal.dismiss()},t.prototype.getType=function(){switch(this.type){case 2:return 2;case 3:return 3;case 5:return 5;default:return 1}},t.prototype.getTitle=function(t){switch(t){case 4:return\"\\u6dfb\\u52a0\\u5176\\u5b83\\u9879\\u76ee\";case 5:return\"\\u9009\\u62e9\\u6750\\u6599\\u6e05\\u5355\";default:return\"\\u9009\\u62e9\\u88c5\\u4fee\\u7c7b\\u578b\"}},t.prototype.visibleHandler=function(t){this.modal.dismiss()},t.prototype.successHandler=function(t){this.modal.close(t)},t}()},oRWq:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return a}),i(\"5aMp\");var s=i(\"f8yE\"),o=(i(\"OHOg\"),i(\"WPLi\"),i(\"t/Na\")),n=i(\"lcOY\"),a=function(){function t(t,e,i,s){this.activeModal=t,this.warn=e,this.req=i,this.qn=s,this.fileList=[],this.images=[],this.loading=!1}return t.prototype.ngOnInit=function(){var t=this;this.qn.getToken()||this.req.doPostImg({url:\"token\",success:function(e){if(e&&200==e.code){var i=JSON.parse(e.data).uptoken,o=JSON.parse(e.data).url;t.qn.setToken(i),t.qn.setDataUrl(o)}else t.warn.onError(e.msg||s.a.FAIL.DATA)}}),this.total||(this.total=n.a.UPLOAD.MAX_NUM),this.num||(this.num=0),this.open||(this.open=!1)},t.prototype.change=function(t){if(t.target.files.length>=n.a.UPLOAD.MAX_NUM)this.warn.onWarn(s.a.ERROR.UPLOAD_IMG_MAX);else{if(t.target.files&&t.target.files.length<n.a.UPLOAD.MAX_NUM){for(var e=t.target.files,i=0;i<e.length;i++)Number(this.coverSize(e[i].size))>n.a.UPLOAD.MAX_SIZE?this.warn.onWarn(e[i].name+\",\\u6587\\u4ef6\\u8d85\\u8fc710M\\uff0c\\u65e0\\u6cd5\\u4e0a\\u4f20\"):(e[i].cid=this.cid,e[i].progress=0,e[i].show=!0,e[i].success=!1,e[i].uploadString=this.split,this.fileList.push(e[i]));if(this.qn.getToken()&&!this.loading){var o=0;for(i=0;i<this.fileList.length;i++)if(!this.fileList[i].success){o=i;break}this.uploadFile(this.fileList,o,this.qn.getToken())}}t.target.value=\"\"}},t.prototype.changeFile=function(t){if(t.target.files.length>=n.a.UPLOAD.MAX_NUM)this.warn.onWarn(s.a.ERROR.UPLOAD_IMG_MAX);else if(t.target.files.length+this.num+this.computedFileShow(this.fileList)>n.a.UPLOAD.MAX_NUM)this.warn.onWarn(s.a.ERROR.IMG_MAX);else{if(t.target.files&&t.target.files.length<n.a.UPLOAD.MAX_NUM){for(var e=t.target.files,i=0;i<e.length;i++)Number(this.coverSize(e[i].size))>n.a.UPLOAD.MAX_SIZE?this.warn.onWarn(e[i].name+\",\\u6587\\u4ef6\\u8d85\\u8fc710M\\uff0c\\u65e0\\u6cd5\\u4e0a\\u4f20\"):(e[i].cid=this.cid,e[i].progress=0,e[i].show=!0,e[i].success=!1,e[i].uploadString=this.split,this.fileList.push(e[i]));if(this.qn.getToken()&&!this.loading){var o=0;for(i=0;i<this.fileList.length;i++)if(!this.fileList[i].success){o=i;break}this.uploadFile(this.fileList,o,this.qn.getToken())}}t.target.value=\"\"}},t.prototype.uploadFile=function(t,e,i){var s=this;e>=t.length||(t[e].success?this.uploadFile(t,++e,i):t[e].request=this.qn.postFile(t[e],i).subscribe(function(n){n.type===o.f.UploadProgress?(s.loading=!0,t[e].progress=Math.round(100*n.loaded/n.total)):n instanceof o.k&&(s.loading=!1,t[e].success=!0,t[e].src=s.qn.getDataUrl()+\"/\"+n.body.key,s.images.push(t[e].src),s.uploadFile(t,++e,i))}))},t.prototype.deleteImage=function(t,e){if(t.stopPropagation(),t.preventDefault(),e&&this.images.length>0){if(this.images.indexOf(e)>-1)for(var i=0;i<this.images.length;i++)this.images[i]===e&&this.images.splice(i,1);if(this.fileList&&this.fileList.length>0)for(i=0;i<this.fileList.length;i++)this.fileList[i].src&&this.fileList[i].src===e&&(this.fileList[i].show=!1)}},t.prototype.removeImage=function(t,e){t.stopPropagation(),t.preventDefault(),this.fileList[e].request&&(this.fileList[e].request.unsubscribe(),this.loading=!1),this.fileList.splice(e,1),this.loading||this.uploadFile(this.fileList,e,this.qn.getToken())},t.prototype.coverSize=function(t){return Number(t/1e3/1024).toFixed(2)},t.prototype.clickImage=function(){this.images&&this.images.length>0?this.activeModal.close(this.images):this.warn.onWarn(s.a.UPLOAD.EMPTY)},t.prototype.computedFileShow=function(t){var e=0;if(t&&t.length>0)for(var i=0,s=t;i<s.length;i++)s[i].show&&e++;return e},t.prototype.ngOnDestroy=function(){this.num=null,this.total=null,this.open=!1},t}()},wR29:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return l});var s=i(\"gIcY\"),o=i(\"EJak\"),n=(i(\"OHOg\"),i(\"5aMp\"),i(\"f8yE\")),a=(i(\"LWby\"),i(\"Xm+O\")),r=i(\"FoyA\"),l=function(){function t(t,e,i,s,o,n){this.modal=t,this.fb=e,this.req=i,this.warn=s,this.config=o,this.modalService=n,this.isEdit=!1}return t.prototype.ngOnInit=function(){if(2===this.type||3===this.type||5===this.type)this.selectType=this.getSelectType(),this.itemForm=this.fb.group({versionType:[{value:this.selectType,disabled:!0},[s.x.required]],versionId:[this.selectVersionId,[s.x.required]]});else if(1===this.type)this.selectType||(this.selectType=2,this.changeChildOptions()),this.itemForm=this.fb.group({versionType:[this.selectType,[s.x.required]],versionId:[this.selectVersionId,[s.x.required]]}),this.versionId&&this.versionType&&(this.selectType=this.versionType,this.selectVersionId=this.versionId,this.save());else if(this.getOtherByState(this.type,this.aid)){if(this.content){var t=this.content;this.isEdit=!0,this.name=t.name,this.num=t.num,this.unit=t.unit,this.univalent=t.univalent,this.discountPrice=t.totalPrice?t.totalPrice:\"0\",this.offerExplain=t.offerExplain}this.itemForm=this.fb.group({name:[this.name,[s.x.required,s.x.minLength(1),s.x.maxLength(100)]],num:[this.num,[s.x.required,s.x.minLength(1),s.x.maxLength(10),o.m]],univalent:[this.univalent,[s.x.required,s.x.minLength(1),s.x.maxLength(10),o.q]],unit:[this.unit,[s.x.required,s.x.minLength(1),s.x.maxLength(10)]],discountPrice:[this.discountPrice,[s.x.required,s.x.minLength(1),s.x.maxLength(10),o.m]],offerExplain:[this.offerExplain,[s.x.maxLength(500)]]})}this.getOtherByState(this.type,this.aid)||this.config.loadConfig(this.id)},t.prototype.ngAfterViewInit=function(){var t=this;setTimeout(function(){if(!t.getOtherByState(t.type,t.aid)&&t.configBase&&t.configBase&&t.configBase.length>0)for(var e=0,i=t.configBase;e<i.length;e++){var s=i[e];t.selectType&&s.type==t.selectType&&(t.changeOptions=s.versions,t.changeOptions&&t.changeOptions.length>0&&(t.selectVersionId=t.versionId?t.versionId:t.changeOptions[0].versionId))}},1500)},t.prototype.ngDoCheck=function(){this.getOtherByState(this.type,this.aid)||(this.configBase=this.config.getConfigBase())},t.prototype.fillCount=function(){if(this.itemForm.get(\"univalent\")&&this.itemForm.get(\"num\")){var t=this.itemForm.get(\"univalent\").valid?this.itemForm.get(\"univalent\").value:\"\",e=this.itemForm.get(\"num\").valid?this.itemForm.get(\"num\").value:\"\",i=String(this.changeToInt(t,2)*this.changeToInt(e,2)/1e4);i=i.lastIndexOf(\".\")>0?i.substring(0,i.lastIndexOf(\".\")+3):i,this.itemForm.get(\"discountPrice\").setValue(i)}},t.prototype.changeToInt=function(t,e){return Object(r.T)(t,e)},t.prototype.cancel=function(){this.modal.dismiss()},t.prototype.submit=function(){var t=this;if(console.log(t.itemForm),t.itemForm.valid){var e=t.itemForm.value;e.id=this.isEdit?t.content.id:t.id,e.num=Number(e.num),e.univalent=Number(e.univalent),e.discountPrice=Number(e.discountPrice),t.req.doPost({url:t.isEdit?\"upOtherQuote\":\"addOtherQuote\",data:e,success:function(e){e&&200==e.code?(t.warn.onSuccess(e.msg||n.a.SUCCESS.DATA),t.modal.close(JSON.stringify(e.data[0]))):t.warn.onError(e.data?e.data:e.msg||n.a.FAIL.DATA)}})}},t.prototype.modify=function(){var t=this;if(this.aid&&this.itemForm.valid){var e=this.itemForm.value;e.totalPrice=Number(e.discountPrice),delete e.discountPrice,e.id=this.aid,e.num=Number(e.num),e.univalent=Number(e.univalent),this.req.doPost({url:\"otherPause\",data:e,success:function(e){t.modal.close(e)}})}},t.prototype.save=function(){var t=this;if(t.itemForm.valid){var e=t.itemForm.value;e.id=t.id,e.type=t.getType(),e.versionType=t.selectType,t.selectVersionId=e.versionId,1!=t.type?t.req.doPost({url:\"choiceVersion\",data:e,success:function(e){if(e&&200==e.code){var i=t.modalService.open(a.a,{centered:!0,keyboard:!0,backdrop:\"static\",size:\"lg\"});i.componentInstance.versionId=t.selectVersionId,i.componentInstance.type=t.getType(),i.componentInstance.offerId=t.id,i.componentInstance.infoName=t.branchName,i.componentInstance.pauseId=t.aid,i.result.then(function(e){t.modal.close(JSON.stringify(e))},function(e){console.log(e),t.modal.dismiss()})}else t.warn.onError(e.msg||n.a.FAIL.DATA)}}):t.modal.close(JSON.stringify(t.itemForm.value))}},t.prototype.changeItem=function(){var t=this;if(t.itemForm.valid){var e=t.itemForm.value;if(e.id=t.id,e.type=t.getType(),e.versionType=t.selectType,t.selectVersionId=e.versionId,1!=t.type){var i=t.modalService.open(a.a,{centered:!0,keyboard:!0,backdrop:\"static\",size:\"lg\"});i.componentInstance.versionId=t.selectVersionId,i.componentInstance.type=t.getType(),i.componentInstance.offerId=t.id,i.componentInstance.infoName=t.branchName,i.componentInstance.pauseId=t.aid,i.result.then(function(e){t.modal.close(JSON.stringify(e))},function(e){t.modal.dismiss()})}}else t.modal.close(JSON.stringify(t.itemForm.value))},t.prototype.store=function(){this.itemForm.valid&&this.modal.close(JSON.stringify(this.itemForm.value))},t.prototype.changeChildOptions=function(){if(this.configBase&&this.configBase.length>0)for(var t=0,e=this.configBase;t<e.length;t++){var i=e[t];this.selectType&&i.type==this.selectType&&(this.changeOptions=i.versions,this.changeOptions&&this.changeOptions.length>0&&(this.selectVersionId=this.changeOptions[0].versionId))}},t.prototype.getTitle=function(t){switch(t){case 4:return\"\\u5176\\u5b83\\u9879\\u76ee\";case 5:return\"\\u9009\\u62e9\\u6750\\u6599\\u6e05\\u5355\";default:return\"\\u9009\\u62e9\\u88c5\\u4fee\\u7c7b\\u578b\"}},t.prototype.getType=function(){switch(this.type){case 2:return 2;case 3:return 3;case 5:return 5;default:return 1}},t.prototype.getSelectType=function(){return Object(r.x)(this.type)},t.prototype.visibleHandler=function(t){this.type=t.type,this.selectType=this.getSelectType(),this.selectVersionId=t.versionId,1===this.selectType&&this.modal.dismiss()},t.prototype.successHandler=function(t){t&&this.modal.close(t)},t.prototype.getOtherByState=function(t,e){return 4===t&&\"undefined\"!=e},t.prototype.ngOnDestroy=function(){this.config.setConfigBase(null)},t}()}}]);","extractedComments":[]}