{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{\"1XgG\":function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return o});var s=i(\"8pQF\"),o=function(){function t(e){t._instance=this;for(var i=this.firstAvailable=new s.a,o=1;o<e;o++){var r=new s.a;i.next=r,i=r}}return Object.defineProperty(t,\"instance\",{get:function(){return t._instance},enumerable:!0,configurable:!0}),t.prototype.borrow=function(t,e){if(null==this.firstAvailable)throw\"Pool exhausted\";this.borrowed++;var i=this.firstAvailable;return this.firstAvailable=i.next,i.x=t,i.y=e,i},t.prototype.returnPoint=function(t){this.borrowed--,t.x=0,t.y=0,t.next=this.firstAvailable,this.firstAvailable=t},t}()},\"8pQF\":function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return s});var s=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return Object.defineProperty(t.prototype,\"next\",{get:function(){return this._next},set:function(t){this._next=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"prev\",{get:function(){return this._prev},set:function(t){this._prev=t},enumerable:!0,configurable:!0}),t}()},MTXN:function(t,e,i){\"use strict\";i(\"glAh\"),i(\"sP4t\"),i(\"QHas\");var s=i(\"sUGQ\"),o=(i(\"uzy7\"),i(\"wmy0\"),i(\"pl9u\"),i(\"OHOg\"),i(\"f8yE\")),r=i(\"lcOY\");i.d(e,\"a\",function(){return n});var n=function(){function t(t,e){this.activeModal=t,this.request=e,this.cropperWidth=0,this.cropperHeight=0,this.MAX_WIDTH=800,this.MAX_HEIGHT=800,this.isClick=!1,this.cropperSettings=new s.a,this.cropperSettings.minWidth=10,this.cropperSettings.minHeight=10,this.cropperSettings.keepAspect=!1,this.cropperSettings.minWithRelativeToResolution=!0,this.cropperSettings.preserveSize=!0,this.cropperSettings.canvasWidth=480,this.cropperSettings.canvasHeight=300,this.cropperSettings.croppedWidth=this.cropperWidth?this.cropperWidth:this.cropperSettings.canvasWidth,this.cropperSettings.croppedHeight=this.cropperHeight?this.cropperHeight:this.cropperSettings.canvasHeight,this.cropperSettings.cropperDrawSettings.strokeColor=\"rgba(11,112,175,0.5)\",this.cropperSettings.cropperDrawSettings.strokeWidth=1,this.cropperSettings.compressRatio=1,this.cropperSettings.noFileInput=!0,this.cropperSettings.touchRadius=20,this.data={}}return t.prototype.ngOnInit=function(){this.name=this.name?this.name:r.a.NAME.UPLOAD_IMG},t.prototype.fileChangeListener=function(t){var e=this,i=new Image,s=t.target.files[0],r=new FileReader;if(Math.ceil(s.size/1024)>102400)return e.showMsg(o.a.UPLOAD.IMG_MAX),void(t.target.value=\"\");r.onload=function(t){i.src=t.target.result,e.cropper.setImage(i)},r.readAsDataURL(s)},t.prototype.cropped=function(t){this.cropperHeight=t.bottom-t.top,this.cropperWidth=t.right-t.left},t.prototype.onClickImage=function(){var t=this;if(t.data.image){t.isClick=!0;var e=new Image;e.src=t.data.image,e.onload=function(){this.height>t.MAX_HEIGHT&&(this.width*=t.MAX_HEIGHT/this.height,this.height=t.MAX_HEIGHT),this.width>t.MAX_WIDTH&&(this.height*=t.MAX_WIDTH/this.width,this.width=t.MAX_WIDTH);var i=document.getElementById(\"canvas\");i.width=this.width,i.height=this.height;var s=i.getContext(\"2d\");s.clearRect(0,0,i.width,i.height),s.drawImage(e,0,0,this.width,this.height),t.data.image=i.toDataURL(\"image/png\",.5),t.request.doPostImg({url:\"token\",success:function(e){if(e&&200==e.code){var i=JSON.parse(e.data).uptoken,s=JSON.parse(e.data).url;t.request.doPostQiniu({token:i,url:s,img:t.data.image,success:function(e){t.isClick=!1,e&&e.key?t.activeModal.close({image:s+\"/\"+e.key}):t.showMsg(o.a.UPLOAD.FAIL)},error:function(e){e&&(t.isClick=!1,t.showMsg(o.a.UPLOAD.NET_BUSY))}})}else t.isClick=!1,t.showMsg(o.a.UPLOAD.NOT_AUTH)}})}}else t.showMsg(o.a.UPLOAD.EMPTY)},t.prototype.showMsg=function(t){var e=this;this.msg=t,setTimeout(function(){e.msg=null},2e3)},t}()},QHas:function(t,e,i){\"use strict\";var s=i(\"mrSG\"),o=i(\"wmy0\"),r=i(\"8pQF\"),n=i(\"sUGQ\"),a=function(){function t(t,e,i,s){this.cropperSettings=new n.a,this.over=!1,this.drag=!1,this._position=new r.a(t,e),this.offset=new r.a(0,0),this.radius=i,this.cropperSettings=s}return t.prototype.setDrag=function(t){this.drag=t,this.setOver(t)},t.prototype.draw=function(t){},t.prototype.setOver=function(t){this.over=t},t.prototype.touchInBounds=function(t,e){return t>this.position.x-this.radius+this.offset.x&&t<this.position.x+this.radius+this.offset.x&&e>this.position.y-this.radius+this.offset.y&&e<this.position.y+this.radius+this.offset.y},Object.defineProperty(t.prototype,\"position\",{get:function(){return this._position},enumerable:!0,configurable:!0}),t.prototype.setPosition=function(t,e){this._position.x=t,this._position.y=e},t}(),h=function(t){function e(e,i,s,o){return t.call(this,e,i,s,o)||this}return Object(s.c)(e,t),e.prototype.drawCornerBorder=function(t){var e=10;(this.over||this.drag)&&(e=12);var i=this.cropperSettings.markerSizeMultiplier,s=this.cropperSettings.markerSizeMultiplier;if(this.horizontalNeighbour.position.x<this.position.x&&(i=-this.cropperSettings.markerSizeMultiplier),this.verticalNeighbour.position.y<this.position.y&&(s=-this.cropperSettings.markerSizeMultiplier),this.cropperSettings.rounded){var o=this.position.x-this.horizontalNeighbour.position.x,r=this.position.y-this.verticalNeighbour.position.y,n=Math.round(Math.sin(Math.PI/2)*Math.abs(o/2))/4,a=Math.round(Math.sin(Math.PI/2)*Math.abs(r/2))/4;this.offset.x=i>0?n:-n,this.offset.y=s>0?a:-a}else this.offset.x=0,this.offset.y=0;t.beginPath(),this.cropperSettings.cropperDrawSettings.lineDash&&t.setLineDash([1,3]),t.lineJoin=\"miter\",t.moveTo(this.position.x+this.offset.x,this.position.y+this.offset.y),t.lineTo(this.position.x+this.offset.x+e*i,this.position.y+this.offset.y),t.lineTo(this.position.x+this.offset.x+e*i,this.position.y+this.offset.y+e*s),t.lineTo(this.position.x+this.offset.x,this.position.y+this.offset.y+e*s),t.lineTo(this.position.x+this.offset.x,this.position.y+this.offset.y),t.closePath(),t.lineWidth=this.cropperSettings.cropperDrawSettings.strokeWidth,t.strokeStyle=this.cropperSettings.cropperDrawSettings.strokeColor||\"rgba(255,255,255,.7)\",t.stroke()},e.prototype.drawCornerFill=function(t){var e=10;(this.over||this.drag)&&(e=12);var i=this.cropperSettings.markerSizeMultiplier,s=this.cropperSettings.markerSizeMultiplier;this.horizontalNeighbour.position.x<this.position.x&&(i=-this.cropperSettings.markerSizeMultiplier),this.verticalNeighbour.position.y<this.position.y&&(s=-this.cropperSettings.markerSizeMultiplier),t.beginPath(),this.cropperSettings.cropperDrawSettings.lineDash&&t.setLineDash([1,3]),t.moveTo(this.position.x+this.offset.x,this.position.y+this.offset.y),t.lineTo(this.position.x+this.offset.x+e*i,this.position.y+this.offset.y),t.lineTo(this.position.x+this.offset.x+e*i,this.position.y+this.offset.y+e*s),t.lineTo(this.position.x+this.offset.x,this.position.y+this.offset.y+e*s),t.lineTo(this.position.x+this.offset.x,this.position.y+this.offset.y),t.closePath(),t.fillStyle=this.cropperSettings.cropperDrawSettings.strokeColor||\"rgba(255,255,255,.7)\",t.fill()},e.prototype.moveX=function(t){this.setPosition(t,this.position.y)},e.prototype.moveY=function(t){this.setPosition(this.position.x,t)},e.prototype.move=function(t,e){this.setPosition(t,e),this.verticalNeighbour.moveX(t),this.horizontalNeighbour.moveY(e)},e.prototype.addHorizontalNeighbour=function(t){this.horizontalNeighbour=t},e.prototype.addVerticalNeighbour=function(t){this.verticalNeighbour=t},e.prototype.getHorizontalNeighbour=function(){return this.horizontalNeighbour},e.prototype.getVerticalNeighbour=function(){return this.verticalNeighbour},e.prototype.draw=function(t){this.drawCornerFill(t),this.drawCornerBorder(t)},e}(a),c=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.id=i,this.x=t,this.y=e},p=i(\"1XgG\"),g=function(t){function e(e,i,s,o){var r=t.call(this,e,i,s,o)||this;return r.iconPoints=[],r.scaledIconPoints=[],r.getDragIconPoints(r.iconPoints,1),r.getDragIconPoints(r.scaledIconPoints,1.2),r}return Object(s.c)(e,t),e.prototype.draw=function(t){this.drawIcon(t,this.over||this.drag?this.scaledIconPoints:this.iconPoints)},e.prototype.getDragIconPoints=function(t,e){var i=17*e,s=14*e,o=8*e,r=4*e;t.push(p.a.instance.borrow(-r/2,i-o)),t.push(p.a.instance.borrow(-s/2,i-o)),t.push(p.a.instance.borrow(0,i)),t.push(p.a.instance.borrow(s/2,i-o)),t.push(p.a.instance.borrow(r/2,i-o)),t.push(p.a.instance.borrow(r/2,r/2)),t.push(p.a.instance.borrow(i-o,r/2)),t.push(p.a.instance.borrow(i-o,s/2)),t.push(p.a.instance.borrow(i,0)),t.push(p.a.instance.borrow(i-o,-s/2)),t.push(p.a.instance.borrow(i-o,-r/2)),t.push(p.a.instance.borrow(r/2,-r/2)),t.push(p.a.instance.borrow(r/2,-i+o)),t.push(p.a.instance.borrow(s/2,-i+o)),t.push(p.a.instance.borrow(0,-i)),t.push(p.a.instance.borrow(-s/2,-i+o)),t.push(p.a.instance.borrow(-r/2,-i+o)),t.push(p.a.instance.borrow(-r/2,-r/2)),t.push(p.a.instance.borrow(-i+o,-r/2)),t.push(p.a.instance.borrow(-i+o,-s/2)),t.push(p.a.instance.borrow(-i,0)),t.push(p.a.instance.borrow(-i+o,s/2)),t.push(p.a.instance.borrow(-i+o,r/2)),t.push(p.a.instance.borrow(-r/2,r/2))},e.prototype.drawIcon=function(t,e){if(this.cropperSettings.showCenterMarker){t.beginPath(),t.moveTo(e[0].x+this.position.x,e[0].y+this.position.y);for(var i=0;i<e.length;i++){var s=e[i];t.lineTo(s.x+this.position.x,s.y+this.position.y)}t.closePath(),t.fillStyle=this.cropperSettings.cropperDrawSettings.dragIconFillColor,t.fill(),t.lineWidth=this.cropperSettings.cropperDrawSettings.dragIconStrokeWidth,t.strokeStyle=this.cropperSettings.cropperDrawSettings.dragIconStrokeColor,t.stroke()}},e.prototype.recalculatePosition=function(t){var e=t.getCentre();this.setPosition(e.x,e.y),p.a.instance.returnPoint(e)},e}(a),u=function(){function t(){}return t.setPressed=function(t){this.pressed=t},t.setReleased=function(t){},t.setOver=function(t){this.over=t},t.setStyle=function(t,e){},t.share={},t}();i.d(e,\"a\",function(){return d});var d=function(t){function e(e){var i=t.call(this)||this,s=e.width,o=e.height,r=e.keepAspect,n=e.touchRadius,a=e.centerTouchRadius,c=e.minWidth,u=e.minHeight,d=e.croppedWidth,l=e.croppedHeight;return i.cropperSettings=e,i.crop=i,i.x=0,i.y=0,i.canvasHeight=e.canvasHeight,i.canvasWidth=e.canvasWidth,i.width=s,void 0===s&&(i.width=100),i.height=o,void 0===o&&(i.height=50),i.keepAspect=r,void 0===r&&(i.keepAspect=!0),i.touchRadius=n,void 0===n&&(i.touchRadius=20),i.minWidth=c,i.minHeight=u,i.aspectRatio=0,i.currentDragTouches=[],i.isMouseDown=!1,i.ratioW=1,i.ratioH=1,i.fileType=e.fileType,i.imageSet=!1,i.pointPool=new p.a(200),i.tl=new h(0,0,n,i.cropperSettings),i.tr=new h(0+s,0,n,i.cropperSettings),i.bl=new h(0,0+o,n,i.cropperSettings),i.br=new h(0+s,0+o,n,i.cropperSettings),i.tl.addHorizontalNeighbour(i.tr),i.tl.addVerticalNeighbour(i.bl),i.tr.addHorizontalNeighbour(i.tl),i.tr.addVerticalNeighbour(i.br),i.bl.addHorizontalNeighbour(i.br),i.bl.addVerticalNeighbour(i.tl),i.br.addHorizontalNeighbour(i.bl),i.br.addVerticalNeighbour(i.tr),i.markers=[i.tl,i.tr,i.bl,i.br],i.center=new g(0+s/2,0+o/2,a,i.cropperSettings),i.aspectRatio=o/s,i.croppedImage=new Image,i.currentlyInteracting=!1,i.cropWidth=d,i.cropHeight=l,i}return Object(s.c)(e,t),e.sign=function(t){return+t===t?0===t?t:t>0?1:-1:NaN},e.getMousePos=function(t,e){var i=t.getBoundingClientRect();return p.a.instance.borrow(e.clientX-i.left,e.clientY-i.top)},e.getTouchPos=function(t,e){var i=t.getBoundingClientRect();return p.a.instance.borrow(e.clientX-i.left,e.clientY-i.top)},e.detectVerticalSquash=function(t){var e=t.height,i=document.createElement(\"canvas\");i.width=1,i.height=e;var s=i.getContext(\"2d\");s.drawImage(t,0,0);var o=s.getImageData(0,0,1,e);if(o){for(var r=o.data,n=0,a=e,h=e;h>n;)0===r[4*(h-1)+3]?a=h:n=h,h=a+n>>1;var c=h/e;return 0===c?1:c}return 1},e.prototype.getDataUriMimeType=function(t){var e=t.substring(0,50),i=\"image/png\",s=RegExp(/^(data:)([\\w\\/\\+]+);(charset=[\\w-]+|base64).*,(.*)/gi).exec(e);return s&&s[2]&&\"image/jpg\"==(i=s[2])&&(i=\"image/jpeg\"),i},e.prototype.prepare=function(t){this.buffer=document.createElement(\"canvas\"),this.cropCanvas=document.createElement(\"canvas\");var e=t.parentElement?t.parentElement.clientWidth:0;e>0&&this.cropperSettings.dynamicSizing?(this.cropCanvas.width=e,this.buffer.width=e,t.width=e):(this.cropCanvas.width=this.cropWidth,this.buffer.width=t.width),this.cropCanvas.height=this.cropHeight,this.buffer.height=t.height,this.canvas=t,this.ctx=this.canvas.getContext(\"2d\"),this.draw(this.ctx)},e.prototype.updateSettings=function(t){this.cropperSettings=t},e.prototype.resizeCanvas=function(t,e,i){void 0===i&&(i=!1),this.canvas.width=this.cropCanvas.width=this.width=this.canvasWidth=this.buffer.width=t,this.canvas.height=this.cropCanvas.height=this.height=this.canvasHeight=this.buffer.height=e,i&&this.setImage(this.srcImage)},e.prototype.reset=function(){this.setImage(void 0)},e.prototype.draw=function(t){var e=this.getBounds();if(this.srcImage){t.clearRect(0,0,this.canvasWidth,this.canvasHeight);var i=this.srcImage.height/this.srcImage.width,s=this.canvasHeight/this.canvasWidth,o=this.canvasWidth,r=this.canvasHeight;s>i?(o=this.canvasWidth,r=this.canvasWidth*i):(r=this.canvasHeight,o=this.canvasHeight/i),this.ratioW=o/this.srcImage.width,this.ratioH=r/this.srcImage.height,s<i?this.drawImageIOSFix(t,this.srcImage,0,0,this.srcImage.width,this.srcImage.height,this.buffer.width/2-o/2,0,o,r):this.drawImageIOSFix(t,this.srcImage,0,0,this.srcImage.width,this.srcImage.height,0,this.buffer.height/2-r/2,o,r),this.buffer.getContext(\"2d\").drawImage(this.canvas,0,0,this.canvasWidth,this.canvasHeight),t.lineWidth=this.cropperSettings.cropperDrawSettings.strokeWidth,t.strokeStyle=this.cropperSettings.cropperDrawSettings.strokeColor,t.fillStyle=\"rgba(0, 0, 0, 0.6)\",this.cropperSettings.rounded?(t.fillRect(0,0,this.canvas.width,this.canvas.height),t.save(),t.beginPath(),t.arc(e.left+e.width/2,e.top+e.height/2,e.width/2,0,2*Math.PI),t.clip(),s<i?this.drawImageIOSFix(t,this.srcImage,0,0,this.srcImage.width,this.srcImage.height,this.buffer.width/2-o/2,0,o,r):this.drawImageIOSFix(t,this.srcImage,0,0,this.srcImage.width,this.srcImage.height,0,this.buffer.height/2-r/2,o,r),t.restore()):(t.fillRect(0,0,this.canvasWidth,this.canvasHeight),t.drawImage(this.buffer,e.left,e.top,Math.max(e.width,1),Math.max(e.height,1),e.left,e.top,e.width,e.height),t.strokeRect(e.left,e.top,e.width,e.height));for(var n=0;n<this.markers.length;n++)this.markers[n].draw(t);this.center.draw(t)}else t.fillStyle=\"rgba(192,192,192,1)\",t.fillRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.dragCenter=function(t,e,i){var s=this.getBounds(),o=t-s.width/2,r=e+s.height/2;t+s.width/2>=this.maxXClamp&&(t=this.maxXClamp-s.width/2),o<=this.minXClamp&&(t=s.width/2+this.minXClamp),e-s.height/2<this.minYClamp&&(e=s.height/2+this.minYClamp),r>=this.maxYClamp&&(e=this.maxYClamp-s.height/2),this.tl.moveX(t-s.width/2),this.tl.moveY(e-s.height/2),this.tr.moveX(t+s.width/2),this.tr.moveY(e-s.height/2),this.bl.moveX(t-s.width/2),this.bl.moveY(e+s.height/2),this.br.moveX(t+s.width/2),this.br.moveY(e+s.height/2),i.setPosition(t,e)},e.prototype.enforceMinSize=function(t,e,i){var s=t-i.getHorizontalNeighbour().position.x,o=e-i.getVerticalNeighbour().position.y,r=this.minWidth-Math.abs(s),n=this.minHeight-Math.abs(o);return 0===s||0===o?p.a.instance.borrow(t=i.position.x,e=i.position.y):(this.keepAspect?r>0&&n/this.aspectRatio>0?r>n/this.aspectRatio?s<0?(t-=r,o<0?e-=r*this.aspectRatio:e+=r*this.aspectRatio):(t+=r,o<0?e-=r*this.aspectRatio:e+=r*this.aspectRatio):o<0?(e-=n,s<0?t-=n/this.aspectRatio:t+=n/this.aspectRatio):(e+=n,s<0?t-=n/this.aspectRatio:t+=n/this.aspectRatio):r>0?s<0?(t-=r,o<0?e-=r*this.aspectRatio:e+=r*this.aspectRatio):(t+=r,o<0?e-=r*this.aspectRatio:e+=r*this.aspectRatio):n>0&&(o<0?(e-=n,s<0?t-=n/this.aspectRatio:t+=n/this.aspectRatio):(e+=n,s<0?t-=n/this.aspectRatio:t+=n/this.aspectRatio)):(r>0&&(s<0?t-=r:t+=r),n>0&&(o<0?e-=n:e+=n)),(t<this.minXClamp||t>this.maxXClamp||e<this.minYClamp||e>this.maxYClamp)&&(t=i.position.x,e=i.position.y),p.a.instance.borrow(t,e))},e.prototype.dragCorner=function(t,e,i){var s,o=0,r=0,n=0,a=0,h=0;if(this.keepAspect)if(o=(s=i.getHorizontalNeighbour().getVerticalNeighbour()).position.x,r=s.position.y,t<=s.position.x)if(e<=s.position.y)if((h=this.getSide(p.a.instance.borrow(o-100/this.aspectRatio,r-100/this.aspectRatio*this.aspectRatio),s.position,p.a.instance.borrow(t,e)))>0){n=Math.abs(s.position.y-e);var c=this.enforceMinSize(s.position.x-(a=n/this.aspectRatio),s.position.y-n,i);i.move(c.x,c.y),p.a.instance.returnPoint(c)}else h<0&&(a=Math.abs(s.position.x-t),c=this.enforceMinSize(s.position.x-a,s.position.y-(n=a*this.aspectRatio),i),i.move(c.x,c.y),p.a.instance.returnPoint(c));else(h=this.getSide(p.a.instance.borrow(o-100/this.aspectRatio,r+100/this.aspectRatio*this.aspectRatio),s.position,p.a.instance.borrow(t,e)))>0?(a=Math.abs(s.position.x-t),c=this.enforceMinSize(s.position.x-a,s.position.y+(n=a*this.aspectRatio),i),i.move(c.x,c.y),p.a.instance.returnPoint(c)):h<0&&(n=Math.abs(s.position.y-e),c=this.enforceMinSize(s.position.x-(a=n/this.aspectRatio),s.position.y+n,i),i.move(c.x,c.y),p.a.instance.returnPoint(c));else e<=s.position.y?(h=this.getSide(p.a.instance.borrow(o+100/this.aspectRatio,r-100/this.aspectRatio*this.aspectRatio),s.position,p.a.instance.borrow(t,e)))<0?(n=Math.abs(s.position.y-e),c=this.enforceMinSize(s.position.x+(a=n/this.aspectRatio),s.position.y-n,i),i.move(c.x,c.y),p.a.instance.returnPoint(c)):h>0&&(a=Math.abs(s.position.x-t),c=this.enforceMinSize(s.position.x+a,s.position.y-(n=a*this.aspectRatio),i),i.move(c.x,c.y),p.a.instance.returnPoint(c)):(h=this.getSide(p.a.instance.borrow(o+100/this.aspectRatio,r+100/this.aspectRatio*this.aspectRatio),s.position,p.a.instance.borrow(t,e)))<0?(a=Math.abs(s.position.x-t),c=this.enforceMinSize(s.position.x+a,s.position.y+(n=a*this.aspectRatio),i),i.move(c.x,c.y),p.a.instance.returnPoint(c)):h>0&&(n=Math.abs(s.position.y-e),c=this.enforceMinSize(s.position.x+(a=n/this.aspectRatio),s.position.y+n,i),i.move(c.x,c.y),p.a.instance.returnPoint(c));else c=this.enforceMinSize(t,e,i),i.move(c.x,c.y),p.a.instance.returnPoint(c);this.center.recalculatePosition(this.getBounds())},e.prototype.getSide=function(t,i,s){var o=e.sign((i.x-t.x)*(s.y-t.y)-(i.y-t.y)*(s.x-t.x));return p.a.instance.returnPoint(t),p.a.instance.returnPoint(s),o},e.prototype.handleRelease=function(t){if(null!=t){for(var e=0,i=0;i<this.currentDragTouches.length;i++)t.id===this.currentDragTouches[i].id&&(this.currentDragTouches[i].dragHandle.setDrag(!1),e=i);this.currentDragTouches.splice(e,1),this.draw(this.ctx)}},e.prototype.handleMove=function(t){for(var e=!1,i=0;i<this.currentDragTouches.length;i++)if(t.id===this.currentDragTouches[i].id&&null!=this.currentDragTouches[i].dragHandle){var s=this.currentDragTouches[i],o=this.clampPosition(t.x-s.dragHandle.offset.x,t.y-s.dragHandle.offset.y);t.x=o.x,t.y=o.y,p.a.instance.returnPoint(o),s.dragHandle instanceof h?this.dragCorner(t.x,t.y,s.dragHandle):this.dragCenter(t.x,t.y,s.dragHandle),this.currentlyInteracting=!0,e=!0,u.setPressed(this.canvas);break}if(!e){for(var r=0;r<this.markers.length;r++){var n=this.markers[r];if(n.touchInBounds(t.x,t.y)){t.dragHandle=n,this.currentDragTouches.push(t),n.setDrag(!0),t.dragHandle.offset.x=t.x-t.dragHandle.position.x,t.dragHandle.offset.y=t.y-t.dragHandle.position.y,this.dragCorner(t.x-t.dragHandle.offset.x,t.y-t.dragHandle.offset.y,t.dragHandle);break}}null!==t.dragHandle&&void 0!==t.dragHandle||this.center.touchInBounds(t.x,t.y)&&(t.dragHandle=this.center,this.currentDragTouches.push(t),t.dragHandle.setDrag(!0),t.dragHandle.offset.x=t.x-t.dragHandle.position.x,t.dragHandle.offset.y=t.y-t.dragHandle.position.y,this.dragCenter(t.x-t.dragHandle.offset.x,t.y-t.dragHandle.offset.y,t.dragHandle))}},e.prototype.updateClampBounds=function(){var t=this.srcImage.height/this.srcImage.width,e=this.canvas.width,i=this.canvas.height;this.canvas.height/this.canvas.width>t?(e=this.canvas.width,i=this.canvas.width*t):(i=this.canvas.height,e=this.canvas.height/t),this.minXClamp=this.canvas.width/2-e/2,this.minYClamp=this.canvas.height/2-i/2,this.maxXClamp=this.canvas.width/2+e/2,this.maxYClamp=this.canvas.height/2+i/2},e.prototype.getCropBounds=function(){var t=this.getBounds();return t.top=Math.round((t.top-this.minYClamp)/this.ratioH),t.bottom=Math.round((t.bottom-this.minYClamp)/this.ratioH),t.left=Math.round((t.left-this.minXClamp)/this.ratioW),t.right=Math.round((t.right-this.minXClamp)/this.ratioW),t},e.prototype.clampPosition=function(t,e){return t<this.minXClamp&&(t=this.minXClamp),t>this.maxXClamp&&(t=this.maxXClamp),e<this.minYClamp&&(e=this.minYClamp),e>this.maxYClamp&&(e=this.maxYClamp),p.a.instance.borrow(t,e)},e.prototype.isImageSet=function(){return this.imageSet},e.prototype.setImage=function(t){if(this.srcImage=t,t){this.imageSet=!0,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.buffer.getContext(\"2d\").clearRect(0,0,this.buffer.width,this.buffer.height),this.cropperSettings.fileType||(this.fileType=this.getDataUriMimeType(t.src)),this.cropperSettings.minWithRelativeToResolution&&(this.minWidth=this.canvas.width*this.cropperSettings.minWidth/this.srcImage.width,this.minHeight=this.canvas.height*this.cropperSettings.minHeight/this.srcImage.height),this.updateClampBounds(),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height;var e=this.getCropPositionFromMarkers();this.setCropPosition(e)}else this.imageSet=!1,this.draw(this.ctx)},e.prototype.updateCropPosition=function(t){var e=this.getCropPositionFromBounds(t);this.setCropPosition(e)},e.prototype.setCropPosition=function(t){this.tl.setPosition(t[0].x,t[0].y),this.tr.setPosition(t[1].x,t[1].y),this.bl.setPosition(t[2].x,t[2].y),this.br.setPosition(t[3].x,t[3].y),this.center.setPosition(t[4].x,t[4].y);for(var i=0,s=t;i<s.length;i++)p.a.instance.returnPoint(s[i]);this.vertSquashRatio=e.detectVerticalSquash(this.srcImage),this.draw(this.ctx),this.croppedImage=this.getCroppedImageHelper(!1,this.cropWidth,this.cropHeight)},e.prototype.getCropPositionFromMarkers=function(){var t,e,i,s,o=this.canvas.width,r=this.canvas.height,n=this.srcImage.height/this.srcImage.width,a=this.getBounds(),h=a.height/a.width,c=this.canvas.width/2,g=this.canvas.height/2;if(h>n){var u=Math.min(o*n,r),d=u/h;t=p.a.instance.borrow(c-d/2,g+u/2),e=p.a.instance.borrow(c+d/2,g+u/2),i=p.a.instance.borrow(c-d/2,g-u/2),s=p.a.instance.borrow(c+d/2,g-u/2)}else{var l=Math.min(r/n,o),f=l*h;t=p.a.instance.borrow(c-l/2,g+f/2),e=p.a.instance.borrow(c+l/2,g+f/2),i=p.a.instance.borrow(c-l/2,g-f/2),s=p.a.instance.borrow(c+l/2,g-f/2)}return[t,e,i,s,p.a.instance.borrow(c,g)]},e.prototype.getCropPositionFromBounds=function(t){var e=0,i=0,s=this.srcImage.height/this.srcImage.width;this.canvasHeight/this.canvasWidth>s?e=this.buffer.height/2-this.canvasWidth*s/2:i=this.buffer.width/2-this.canvasHeight/s/2;var o=(this.canvasWidth-2*i)/this.srcImage.width,r=(this.canvasHeight-2*e)/this.srcImage.height,n=t.height*r,a=t.width*o,h=t.left*o+i,c=t.top*r+e;if(this.keepAspect){var g=n/this.aspectRatio,u=a*this.aspectRatio;this.getCropBounds().height===t.height?n=u:this.getCropBounds().width===t.width?a=g:Math.abs(u-n)<Math.abs(g-a)?a=g:n=u}return[p.a.instance.borrow(h,c+n),p.a.instance.borrow(h+a,c+n),p.a.instance.borrow(h,c),p.a.instance.borrow(h+a,c),p.a.instance.borrow(h+a/2,c+n/2)]},e.prototype.getCroppedImageHelper=function(t,e,i){return this.cropperSettings.cropOnResize?this.getCroppedImage(t,e,i):this.croppedImage?this.croppedImage:document.createElement(\"img\")},e.prototype.getCroppedImage=function(t,e,i){var s=this.getBounds();if(this.srcImage){var o=this.srcImage.height/this.srcImage.width,r=this.canvas.height/this.canvas.width,n=this.canvas.width,a=this.canvas.height;r>o?(n=this.canvas.width,a=this.canvas.width*o):r<o?(a=this.canvas.height,n=this.canvas.height/o):(a=this.canvas.height,n=this.canvas.width),this.ratioW=n/this.srcImage.width,this.ratioH=a/this.srcImage.height;var h=(this.buffer.height-a)/2/this.ratioH,c=(this.buffer.width-n)/2/this.ratioW,p=this.cropCanvas.getContext(\"2d\");if(this.cropperSettings.preserveSize||t){var g=Math.round(s.right/this.ratioW-s.left/this.ratioW),u=Math.round(s.bottom/this.ratioH-s.top/this.ratioH);this.cropCanvas.width=g,this.cropCanvas.height=u,this.cropperSettings.croppedWidth=this.cropCanvas.width,this.cropperSettings.croppedHeight=this.cropCanvas.height}else this.cropCanvas.width=this.cropWidth,this.cropCanvas.height=this.cropHeight;return p.clearRect(0,0,this.cropCanvas.width,this.cropCanvas.height),this.drawImageIOSFix(p,this.srcImage,Math.max(Math.round(s.left/this.ratioW-c),0),Math.max(Math.round(s.top/this.ratioH-h),0),Math.max(Math.round(s.width/this.ratioW),1),Math.max(Math.round(s.height/this.ratioH),1),0,0,this.cropCanvas.width,this.cropCanvas.height),this.cropperSettings.resampleFn&&this.cropperSettings.resampleFn(this.cropCanvas),this.croppedImage.width=this.cropCanvas.width,this.croppedImage.height=this.cropCanvas.height,this.croppedImage.src=this.cropCanvas.toDataURL(this.fileType,this.cropperSettings.compressRatio),this.croppedImage}return document.createElement(\"img\")},e.prototype.getBounds=function(){for(var t=Number.MAX_VALUE,e=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=-Number.MAX_VALUE,r=0;r<this.markers.length;r++){var n=this.markers[r];n.position.x<t&&(t=n.position.x),n.position.x>i&&(i=n.position.x),n.position.y<e&&(e=n.position.y),n.position.y>s&&(s=n.position.y)}var a=new o.a;return a.left=t,a.right=i,a.top=e,a.bottom=s,a},e.prototype.setBounds=function(t){for(var e=this.getBounds(),i=0;i<this.markers.length;i++){var s=this.markers[i];s.setPosition(s.position.x===e.left?t.left:t.right,s.position.y===e.top?t.top:t.bottom)}this.center.recalculatePosition(t),this.center.draw(this.ctx),this.draw(this.ctx)},e.prototype.onTouchMove=function(t){if(this.crop.isImageSet()){if(1===t.touches.length){if(this.isMouseDown){t.preventDefault();for(var i=0;i<t.touches.length;i++){var s=t.touches[i],o=e.getTouchPos(this.canvas,s),r=new c(o.x,o.y,s.identifier);p.a.instance.returnPoint(o),this.move(r)}}}else if(2===t.touches.length){t.preventDefault();var n=(t.touches[0].clientX-t.touches[1].clientX)*(t.touches[0].clientX-t.touches[1].clientX)+(t.touches[0].clientY-t.touches[1].clientY)*(t.touches[0].clientY-t.touches[1].clientY);if(this.previousDistance&&this.previousDistance!==n){var a=this.getBounds();n<this.previousDistance&&(a.top+=1,a.left+=1,a.right-=1,a.bottom-=1),n>this.previousDistance&&(a.top!==this.minYClamp&&a.bottom!==this.maxYClamp&&a.left!==this.minXClamp&&a.right!==this.maxXClamp?(a.top-=1,a.left-=1,a.right+=1,a.bottom+=1):a.top!==this.minYClamp&&a.bottom!==this.maxYClamp&&a.left===this.minXClamp&&a.right!==this.maxXClamp?(a.top-=1,a.right+=2,a.bottom+=1):a.top!==this.minYClamp&&a.bottom!==this.maxYClamp&&a.left!==this.minXClamp&&a.right===this.maxXClamp?(a.top-=1,a.left-=2,a.bottom+=1):a.top===this.minYClamp&&a.bottom!==this.maxYClamp&&a.left!==this.minXClamp&&a.right!==this.maxXClamp?(a.left-=1,a.right+=1,a.bottom+=2):a.top!==this.minYClamp&&a.bottom===this.maxYClamp&&a.left!==this.minXClamp&&a.right!==this.maxXClamp?(a.top-=2,a.left-=1,a.right+=1):a.top===this.minYClamp&&a.bottom!==this.maxYClamp&&a.left===this.minXClamp&&a.right!==this.maxXClamp?(a.right+=2,a.bottom+=2):a.top===this.minYClamp&&a.bottom!==this.maxYClamp&&a.left!==this.minXClamp&&a.right===this.maxXClamp?(a.left-=2,a.bottom+=2):a.top!==this.minYClamp&&a.bottom===this.maxYClamp&&a.left===this.minXClamp&&a.right!==this.maxXClamp?(a.top-=2,a.right+=2):a.top!==this.minYClamp&&a.bottom===this.maxYClamp&&a.left!==this.minXClamp&&a.right===this.maxXClamp&&(a.top-=2,a.left-=2)),a.top<this.minYClamp&&(a.top=this.minYClamp),a.bottom>this.maxYClamp&&(a.bottom=this.maxYClamp),a.left<this.minXClamp&&(a.left=this.minXClamp),a.right>this.maxXClamp&&(a.right=this.maxXClamp),this.setBounds(a)}this.previousDistance=n}this.draw(this.ctx)}},e.prototype.onMouseMove=function(t){if(this.crop.isImageSet()&&this.isMouseDown){var i=e.getMousePos(this.canvas,t);this.move(new c(i.x,i.y,0));var s=this.getDragTouchForID(0);s?(s.x=i.x,s.y=i.y):s=new c(i.x,i.y,0),p.a.instance.returnPoint(i),this.drawCursors(s),this.draw(this.ctx)}},e.prototype.move=function(t){this.isMouseDown&&this.handleMove(t)},e.prototype.getDragTouchForID=function(t){for(var e=0;e<this.currentDragTouches.length;e++)if(t===this.currentDragTouches[e].id)return this.currentDragTouches[e]},e.prototype.drawCursors=function(t){var e=!1;null!=t&&(t.dragHandle===this.center&&(u.setStyle(this.canvas,\"move\"),e=!0),null!==t.dragHandle&&t.dragHandle instanceof h&&(this.drawCornerCursor(t.dragHandle,t.dragHandle.position.x,t.dragHandle.position.y),e=!0));var i=!1;if(!e){for(var s=0;s<this.markers.length;s++)i=i||this.drawCornerCursor(this.markers[s],t.x,t.y);i||u.setStyle(this.canvas,\"initial\")}i||e||!this.center.touchInBounds(t.x,t.y)?this.center.setOver(!1):(this.center.setOver(!0),u.setOver(this.canvas),u.setStyle(this.canvas,\"move\"))},e.prototype.drawCornerCursor=function(t,e,i){return t.touchInBounds(e,i)?(t.setOver(!0),t.getHorizontalNeighbour().position.x>t.position.x?t.getVerticalNeighbour().position.y>t.position.y?(u.setOver(this.canvas),u.setStyle(this.canvas,\"nwse-resize\")):(u.setOver(this.canvas),u.setStyle(this.canvas,\"nesw-resize\")):t.getVerticalNeighbour().position.y>t.position.y?(u.setOver(this.canvas),u.setStyle(this.canvas,\"nesw-resize\")):(u.setOver(this.canvas),u.setStyle(this.canvas,\"nwse-resize\")),!0):(t.setOver(!1),!1)},e.prototype.onTouchStart=function(t){if(this.crop.isImageSet()){var i=t.touches[0],s=e.getTouchPos(this.canvas,i),o=new c(s.x,s.y,i.identifier);p.a.instance.returnPoint(s),this.isMouseDown=!1;for(var r=0;r<this.markers.length;r++)this.markers[r].touchInBounds(o.x,o.y)&&(this.isMouseDown=!0);this.center.touchInBounds(o.x,o.y)&&(this.isMouseDown=!0)}},e.prototype.onTouchEnd=function(t){if(this.crop.isImageSet()){for(var e=0;e<t.changedTouches.length;e++){var i=this.getDragTouchForID(t.changedTouches[e].identifier);i&&void 0!==i&&((i.dragHandle instanceof h||i.dragHandle instanceof g)&&i.dragHandle.setOver(!1),this.handleRelease(i))}0===this.currentDragTouches.length&&(this.isMouseDown=!1,this.currentlyInteracting=!1)}},e.prototype.drawImageIOSFix=function(t,e,i,s,o,r,n,a,h,c){t.drawImage(e,i,s,o,r,n,a,h,c)},e.prototype.onMouseDown=function(t){this.crop.isImageSet()&&(this.isMouseDown=!0)},e.prototype.onMouseUp=function(t){this.crop.isImageSet()&&(u.setReleased(this.canvas),this.isMouseDown=!1,this.handleRelease(new c(0,0,0)))},e}(function(){})},glAh:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return s}),i(\"sP4t\");var s=function(){}},pl9u:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return o});var s=i(\"wmy0\"),o=function(){function t(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.x=+t,this.y=+e,this.w=+i,this.h=+s}return t.prototype.toBounds=function(){return new s.a(this.x,this.y,this.w,this.h)},t.prototype.isInitialized=function(){return 0!==this.x&&0!==this.y&&0!==this.w&&0!==this.h},t}()},sP4t:function(t,e,i){\"use strict\";var s=i(\"CcnG\"),o=i(\"QHas\"),r=i(\"sUGQ\"),n=i(\"mrSG\"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(n.c)(e,t),e}(Number),h=function(){function t(){}return t.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c.debug&&console.log(t)},t}(),c=function(){function t(){}return t.addEvent=function(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent(\"on\"+e,i)},t.imageHasData=function(t){return!!t.exifdata},t.base64ToArrayBuffer=function(t){t=t.replace(/^data:([^;]+);base64,/gim,\"\");for(var e=atob(t),i=e.length,s=new ArrayBuffer(i),o=new Uint8Array(s),r=0;r<i;r++)o[r]=e.charCodeAt(r);return s},t.objectURLToBlob=function(t,e){var i=new XMLHttpRequest;i.open(\"GET\",t,!0),i.responseType=\"blob\",i.onload=function(){200!==i.status&&0!==i.status||e(i.response)},i.send()},t.getImageData=function(e,i){function s(s){var o=t.findEXIFinJPEG(s),r=t.findIPTCinJPEG(s);e.exifdata=o||{},e.iptcdata=r||{},i&&i.call(e)}if(\"src\"in e&&e.src)if(/^data:/i.test(e.src))s(t.base64ToArrayBuffer(e.src));else if(/^blob:/i.test(e.src)){var o=new FileReader;o.onload=function(t){s(t.target.result)},t.objectURLToBlob(e.src,function(t){o.readAsArrayBuffer(t)})}else{var r=new XMLHttpRequest;r.onload=function(){if(200!==r.status&&0!==r.status)throw\"Could not load image\";s(r.response)},r.open(\"GET\",e.src,!0),r.responseType=\"arraybuffer\",r.send(null)}else if(FileReader&&(e instanceof Blob||e instanceof File)){var n=new FileReader;n.onload=function(t){h.log(\"Got file of length \"+t.target.result.byteLength),s(t.target.result)},n.readAsArrayBuffer(e)}},t.findEXIFinJPEG=function(e){var i=new DataView(e);if(h.log(\"Got file of length \"+e.byteLength),255!==i.getUint8(0)||216!==i.getUint8(1))return h.log(\"Not a valid JPEG\"),!1;for(var s,o=2,r=e.byteLength;o<r;){if(255!==i.getUint8(o))return h.log(\"Not a valid marker at offset \"+o+\", found: \"+i.getUint8(o)),!1;if(s=i.getUint8(o+1),h.log(s),225===s)return h.log(\"Found 0xFFE1 marker\"),t.readEXIFData(i,o+4);o+=2+i.getUint16(o+2)}},t.findIPTCinJPEG=function(e){var i=new DataView(e);if(h.log(\"Got file of length \"+e.byteLength),255!==i.getUint8(0)||216!==i.getUint8(1))return h.log(\"Not a valid JPEG\"),!1;for(var s,o,r=2,n=e.byteLength;r<n;){if(56===(s=i).getUint8(o=r)&&66===s.getUint8(o+1)&&73===s.getUint8(o+2)&&77===s.getUint8(o+3)&&4===s.getUint8(o+4)&&4===s.getUint8(o+5)){var a=i.getUint8(r+7);a%2!=0&&(a+=1),0===a&&(a=4);var c=r+8+a,p=i.getUint16(r+6+a);return t.readIPTCData(e,c,p)}r++}},t.readIPTCData=function(e,i,s){for(var o,r,n,a,h=new DataView(e),c={},p=i;p<i+s;)28===h.getUint8(p)&&2===h.getUint8(p+1)&&(a=h.getUint8(p+2))in t.IptcFieldMap&&(n=h.getInt16(p+3),r=t.IptcFieldMap[a],o=t.getStringFromDB(h,p+5,n),c.hasOwnProperty(r)?c[r]instanceof Array?c[r].push(o):c[r]=[c[r],o]:c[r]=o),p++;return c},t.readTags=function(e,i,s,o,r){for(var n,a,c=e.getUint16(s,!r),p={},g=0;g<c;g++)(a=o[e.getUint16(n=s+12*g+2,!r)])||h.log(\"Unknown tag: \"+e.getUint16(n,!r)),p[a]=t.readTagValue(e,n,i,s,r);return p},t.readTagValue=function(e,i,s,o,r){var n,h,c,p,g,u,d=e.getUint16(i+2,!r),l=e.getUint32(i+4,!r),f=e.getUint32(i+8,!r)+s;switch(d){case 1:case 7:if(1===l)return e.getUint8(i+8,!r);for(n=l>4?f:i+8,h=[],p=0;p<l;p++)h[p]=e.getUint8(n+p);return h;case 2:return t.getStringFromDB(e,n=l>4?f:i+8,l-1);case 3:if(1===l)return e.getUint16(i+8,!r);for(n=l>2?f:i+8,h=[],p=0;p<l;p++)h[p]=e.getUint16(n+2*p,!r);return h;case 4:if(1===l)return e.getUint32(i+8,!r);for(h=[],p=0;p<l;p++)h[p]=e.getUint32(f+4*p,!r);return h;case 5:if(1===l)return g=e.getUint32(f,!r),u=e.getUint32(f+4,!r),(c=new a(g/u)).numerator=g,c.denominator=u,c;for(h=[],p=0;p<l;p++)g=e.getUint32(f+8*p,!r),u=e.getUint32(f+4+8*p,!r),h[p]=new a(g/u),h[p].numerator=g,h[p].denominator=u;return h;case 9:if(1===l)return e.getInt32(i+8,!r);for(h=[],p=0;p<l;p++)h[p]=e.getInt32(f+4*p,!r);return h;case 10:if(1===l)return e.getInt32(f,!r)/e.getInt32(f+4,!r);for(h=[],p=0;p<l;p++)h[p]=e.getInt32(f+8*p,!r)/e.getInt32(f+4+8*p,!r);return h}},t.getStringFromDB=function(t,e,i){for(var s=\"\",o=e;o<e+i;o++)s+=String.fromCharCode(t.getUint8(o));return s},t.readEXIFData=function(e,i){if(\"Exif\"!==t.getStringFromDB(e,i,4))return h.log(\"Not valid EXIF data! \"+t.getStringFromDB(e,i,4)),!1;var s,o,r,n,a,c=i+6;if(18761===e.getUint16(c))s=!1;else{if(19789!==e.getUint16(c))return h.log(\"Not valid TIFF data! (no 0x4949 or 0x4D4D)\"),!1;s=!0}if(42!==e.getUint16(c+2,!s))return h.log(\"Not valid TIFF data! (no 0x002A)\"),!1;var p=e.getUint32(c+4,!s);if(p<8)return h.log(\"Not valid TIFF data! (First offset less than 8)\",e.getUint32(c+4,!s)),!1;if((o=t.readTags(e,c,c+p,t.TiffTags,s)).ExifIFDPointer)for(r in n=t.readTags(e,c,c+o.ExifIFDPointer,t.Tags,s))if({}.hasOwnProperty.call(n,r)){switch(r){case\"LightSource\":case\"Flash\":case\"MeteringMode\":case\"ExposureProgram\":case\"SensingMethod\":case\"SceneCaptureType\":case\"SceneType\":case\"CustomRendered\":case\"WhiteBalance\":case\"GainControl\":case\"Contrast\":case\"Saturation\":case\"Sharpness\":case\"SubjectDistanceRange\":case\"FileSource\":n[r]=t.StringValues[r][n[r]];break;case\"ExifVersion\":case\"FlashpixVersion\":n[r]=String.fromCharCode(n[r][0],n[r][1],n[r][2],n[r][3]);break;case\"ComponentsConfiguration\":n[r]=t.StringValues.Components[n[r][0]]+t.StringValues.Components[n[r][1]]+t.StringValues.Components[n[r][2]]+t.StringValues.Components[n[r][3]]}o[r]=n[r]}if(o.GPSInfoIFDPointer)for(r in a=t.readTags(e,c,c+o.GPSInfoIFDPointer,t.GPSTags,s))if({}.hasOwnProperty.call(a,r)){switch(r){case\"GPSVersionID\":a[r]=a[r][0]+\".\"+a[r][1]+\".\"+a[r][2]+\".\"+a[r][3]}o[r]=a[r]}return o},t.checkImageType=function(t){return t instanceof Image||t instanceof HTMLImageElement},t.getData=function(e,i){return!(this.checkImageType(e)&&!e.complete||(t.imageHasData(e)?i&&i.call(e):t.getImageData(e,i),0))},t.getTag=function(e,i){if(t.imageHasData(e))return e.exifdata[i]},t.getAllTags=function(e){if(!t.imageHasData(e))return{};var i,s=e.exifdata,o={};for(i in s)s.hasOwnProperty(i)&&(o[i]=s[i]);return o},t.pretty=function(e){if(!t.imageHasData(e))return\"\";var i,s=e.exifdata,o=\"\";for(i in s)s.hasOwnProperty(i)&&(\"object\"==typeof s[i]?s[i]instanceof Number?o+=i+\" : \"+s[i]+\" [\"+s[i].numerator+\"/\"+s[i].denominator+\"]\\r\\n\":o+=i+\" : [\"+s[i].length+\" values]\\r\\n\":o+=i+\" : \"+s[i]+\"\\r\\n\");return o},t.readFromBinaryFile=function(e){return t.findEXIFinJPEG(e)},t.debug=!1,t.IptcFieldMap={120:\"caption\",110:\"credit\",25:\"keywords\",55:\"dateCreated\",80:\"byline\",85:\"bylineTitle\",122:\"captionWriter\",105:\"headline\",116:\"copyright\",15:\"category\"},t.Tags={36864:\"ExifVersion\",40960:\"FlashpixVersion\",40961:\"ColorSpace\",40962:\"PixelXDimension\",40963:\"PixelYDimension\",37121:\"ComponentsConfiguration\",37122:\"CompressedBitsPerPixel\",37500:\"MakerNote\",37510:\"UserComment\",40964:\"RelatedSoundFile\",36867:\"DateTimeOriginal\",36868:\"DateTimeDigitized\",37520:\"SubsecTime\",37521:\"SubsecTimeOriginal\",37522:\"SubsecTimeDigitized\",33434:\"ExposureTime\",33437:\"FNumber\",34850:\"ExposureProgram\",34852:\"SpectralSensitivity\",34855:\"ISOSpeedRatings\",34856:\"OECF\",37377:\"ShutterSpeedValue\",37378:\"ApertureValue\",37379:\"BrightnessValue\",37380:\"ExposureBias\",37381:\"MaxApertureValue\",37382:\"SubjectDistance\",37383:\"MeteringMode\",37384:\"LightSource\",37385:\"Flash\",37396:\"SubjectArea\",37386:\"FocalLength\",41483:\"FlashEnergy\",41484:\"SpatialFrequencyResponse\",41486:\"FocalPlaneXResolution\",41487:\"FocalPlaneYResolution\",41488:\"FocalPlaneResolutionUnit\",41492:\"SubjectLocation\",41493:\"ExposureIndex\",41495:\"SensingMethod\",41728:\"FileSource\",41729:\"SceneType\",41730:\"CFAPattern\",41985:\"CustomRendered\",41986:\"ExposureMode\",41987:\"WhiteBalance\",41988:\"DigitalZoomRation\",41989:\"FocalLengthIn35mmFilm\",41990:\"SceneCaptureType\",41991:\"GainControl\",41992:\"Contrast\",41993:\"Saturation\",41994:\"Sharpness\",41995:\"DeviceSettingDescription\",41996:\"SubjectDistanceRange\",40965:\"InteroperabilityIFDPointer\",42016:\"ImageUniqueID\"},t.TiffTags={256:\"ImageWidth\",257:\"ImageHeight\",34665:\"ExifIFDPointer\",34853:\"GPSInfoIFDPointer\",40965:\"InteroperabilityIFDPointer\",258:\"BitsPerSample\",259:\"Compression\",262:\"PhotometricInterpretation\",274:\"Orientation\",277:\"SamplesPerPixel\",284:\"PlanarConfiguration\",530:\"YCbCrSubSampling\",531:\"YCbCrPositioning\",282:\"XResolution\",283:\"YResolution\",296:\"ResolutionUnit\",273:\"StripOffsets\",278:\"RowsPerStrip\",279:\"StripByteCounts\",513:\"JPEGInterchangeFormat\",514:\"JPEGInterchangeFormatLength\",301:\"TransferFunction\",318:\"WhitePoint\",319:\"PrimaryChromaticities\",529:\"YCbCrCoefficients\",532:\"ReferenceBlackWhite\",306:\"DateTime\",270:\"ImageDescription\",271:\"Make\",272:\"Model\",305:\"Software\",315:\"Artist\",33432:\"Copyright\"},t.GPSTags={0:\"GPSVersionID\",1:\"GPSLatitudeRef\",2:\"GPSLatitude\",3:\"GPSLongitudeRef\",4:\"GPSLongitude\",5:\"GPSAltitudeRef\",6:\"GPSAltitude\",7:\"GPSTimeStamp\",8:\"GPSSatellites\",9:\"GPSStatus\",10:\"GPSMeasureMode\",11:\"GPSDOP\",12:\"GPSSpeedRef\",13:\"GPSSpeed\",14:\"GPSTrackRef\",15:\"GPSTrack\",16:\"GPSImgDirectionRef\",17:\"GPSImgDirection\",18:\"GPSMapDatum\",19:\"GPSDestLatitudeRef\",20:\"GPSDestLatitude\",21:\"GPSDestLongitudeRef\",22:\"GPSDestLongitude\",23:\"GPSDestBearingRef\",24:\"GPSDestBearing\",25:\"GPSDestDistanceRef\",26:\"GPSDestDistance\",27:\"GPSProcessingMethod\",28:\"GPSAreaInformation\",29:\"GPSDateStamp\",30:\"GPSDifferential\"},t.StringValues={ExposureProgram:{0:\"Not defined\",1:\"Manual\",2:\"Normal program\",3:\"Aperture priority\",4:\"Shutter priority\",5:\"Creative program\",6:\"Action program\",7:\"Portrait mode\",8:\"Landscape mode\"},MeteringMode:{0:\"Unknown\",1:\"Average\",2:\"CenterWeightedAverage\",3:\"Spot\",4:\"MultiSpot\",5:\"Pattern\",6:\"Partial\",255:\"Other\"},LightSource:{0:\"Unknown\",1:\"Daylight\",2:\"Fluorescent\",3:\"Tungsten (incandescent light)\",4:\"Flash\",9:\"Fine weather\",10:\"Cloudy weather\",11:\"Shade\",12:\"Daylight fluorescent (D 5700 - 7100K)\",13:\"Day white fluorescent (N 4600 - 5400K)\",14:\"Cool white fluorescent (W 3900 - 4500K)\",15:\"White fluorescent (WW 3200 - 3700K)\",17:\"Standard light A\",18:\"Standard light B\",19:\"Standard light C\",20:\"D55\",21:\"D65\",22:\"D75\",23:\"D50\",24:\"ISO studio tungsten\",255:\"Other\"},Flash:{0:\"Flash did not fire\",1:\"Flash fired\",5:\"Strobe return light not detected\",7:\"Strobe return light detected\",9:\"Flash fired, compulsory flash mode\",13:\"Flash fired, compulsory flash mode, return light not detected\",15:\"Flash fired, compulsory flash mode, return light detected\",16:\"Flash did not fire, compulsory flash mode\",24:\"Flash did not fire, auto mode\",25:\"Flash fired, auto mode\",29:\"Flash fired, auto mode, return light not detected\",31:\"Flash fired, auto mode, return light detected\",32:\"No flash function\",65:\"Flash fired, red-eye reduction mode\",69:\"Flash fired, red-eye reduction mode, return light not detected\",71:\"Flash fired, red-eye reduction mode, return light detected\",73:\"Flash fired, compulsory flash mode, red-eye reduction mode\",77:\"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected\",79:\"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected\",89:\"Flash fired, auto mode, red-eye reduction mode\",93:\"Flash fired, auto mode, return light not detected, red-eye reduction mode\",95:\"Flash fired, auto mode, return light detected, red-eye reduction mode\"},SensingMethod:{1:\"Not defined\",2:\"One-chip color area sensor\",3:\"Two-chip color area sensor\",4:\"Three-chip color area sensor\",5:\"Color sequential area sensor\",7:\"Trilinear sensor\",8:\"Color sequential linear sensor\"},SceneCaptureType:{0:\"Standard\",1:\"Landscape\",2:\"Portrait\",3:\"Night scene\"},SceneType:{1:\"Directly photographed\"},CustomRendered:{0:\"Normal process\",1:\"Custom process\"},WhiteBalance:{0:\"Auto white balance\",1:\"Manual white balance\"},GainControl:{0:\"None\",1:\"Low gain up\",2:\"High gain up\",3:\"Low gain down\",4:\"High gain down\"},Contrast:{0:\"Normal\",1:\"Soft\",2:\"Hard\"},Saturation:{0:\"Normal\",1:\"Low saturation\",2:\"High saturation\"},Sharpness:{0:\"Normal\",1:\"Soft\",2:\"Hard\"},SubjectDistanceRange:{0:\"Unknown\",1:\"Macro\",2:\"Close view\",3:\"Distant view\"},FileSource:{3:\"DSC\"},Components:{0:\"\",1:\"Y\",2:\"Cb\",3:\"Cr\",4:\"R\",5:\"G\",6:\"B\"}},t}(),p=i(\"pl9u\");i.d(e,\"a\",function(){return g});var g=function(){function t(t){this.cropPositionChange=new s.m,this.onCrop=new s.m,this.imageSet=new s.m,this.renderer=t}return t.prototype.ngAfterViewInit=function(){var t=this.cropcanvas.nativeElement;this.settings||(this.settings=new r.a),this.settings.cropperClass&&this.renderer.setAttribute(t,\"class\",this.settings.cropperClass),this.settings.dynamicSizing?(this.windowListener=this.resize.bind(this),window.addEventListener(\"resize\",this.windowListener)):(this.renderer.setAttribute(t,\"width\",this.settings.canvasWidth.toString()),this.renderer.setAttribute(t,\"height\",this.settings.canvasHeight.toString())),this.cropper||(this.cropper=new o.a(this.settings)),this.cropper.prepare(t)},t.prototype.ngOnChanges=function(t){if(this.isCropPositionChanged(t)){if(this.cropper.updateCropPosition(this.cropPosition.toBounds()),this.cropper.isImageSet()){var e=this.cropper.getCropBounds();this.image.image=this.cropper.getCroppedImageHelper().src,this.onCrop.emit(e)}this.updateCropBounds()}t.inputImage&&this.setImage(t.inputImage.currentValue),t.settings&&this.cropper&&this.cropper.isImageSet()&&(this.cropper.updateSettings(this.settings),this.image.image=this.cropper.getCroppedImageHelper().src,this.onCrop.emit(this.cropper.getCropBounds()))},t.prototype.ngOnDestroy=function(){this.settings.dynamicSizing&&this.windowListener&&window.removeEventListener(\"resize\",this.windowListener)},t.prototype.onTouchMove=function(t){this.cropper.onTouchMove(t)},t.prototype.onTouchStart=function(t){this.cropper.onTouchStart(t)},t.prototype.onTouchEnd=function(t){this.cropper.onTouchEnd(t),this.cropper.isImageSet()&&(this.image.image=this.cropper.getCroppedImageHelper().src,this.onCrop.emit(this.cropper.getCropBounds()),this.updateCropBounds())},t.prototype.onMouseDown=function(t){this.cropper.onMouseDown(t)},t.prototype.onMouseUp=function(t){this.cropper.isImageSet()&&(this.cropper.onMouseUp(t),this.image.image=this.cropper.getCroppedImageHelper().src,this.onCrop.emit(this.cropper.getCropBounds()),this.updateCropBounds())},t.prototype.onMouseMove=function(t){this.cropper.onMouseMove(t)},t.prototype.fileChangeListener=function(t){var e=this;if(0!==t.target.files.length){var i=t.target.files[0];if(this.settings.allowedFilesRegex.test(i.name)){var s=new Image,o=new FileReader;o.addEventListener(\"loadend\",function(t){s.addEventListener(\"load\",function(){e.setImage(s)}),s.src=t.target.result}),o.readAsDataURL(i)}}},t.prototype.resize=function(){var t=this.cropcanvas.nativeElement;this.settings.canvasWidth=t.offsetWidth,this.settings.canvasHeight=t.offsetHeight,this.cropper.resizeCanvas(t.offsetWidth,t.offsetHeight,!0)},t.prototype.reset=function(){this.cropper.reset(),this.renderer.setAttribute(this.cropcanvas.nativeElement,\"class\",this.settings.cropperClass),this.image.image=this.cropper.getCroppedImageHelper().src},t.prototype.setImage=function(t,e){var i=this;void 0===e&&(e=null),this.imageSet.emit(!0),this.renderer.setAttribute(this.cropcanvas.nativeElement,\"class\",this.settings.cropperClass+\" \"+this.settings.croppingClass),this.raf=window.requestAnimationFrame(function(){i.raf&&window.cancelAnimationFrame(i.raf),t.naturalHeight>0&&t.naturalWidth>0&&(t.height=t.naturalHeight,t.width=t.naturalWidth,window.cancelAnimationFrame(i.raf),i.getOrientedImage(t,function(s){if(i.settings.dynamicSizing){var o=i.cropcanvas.nativeElement;i.settings.canvasWidth=o.offsetWidth,i.settings.canvasHeight=o.offsetHeight,i.cropper.resizeCanvas(o.offsetWidth,o.offsetHeight,!1)}i.cropper.setImage(s),i.cropPosition&&i.cropPosition.isInitialized()&&i.cropper.updateCropPosition(i.cropPosition.toBounds()),i.image.original=s;var r=i.cropper.getCropBounds();i.image.image=i.cropper.getCroppedImageHelper().src,i.image||(i.image=t),null!=e&&(i.cropper.setBounds(r=e),i.cropper.updateCropPosition(r)),i.onCrop.emit(r)}))})},t.prototype.isCropPositionChanged=function(t){return!!(this.cropper&&t.cropPosition&&this.isCropPositionUpdateNeeded)||(this.isCropPositionUpdateNeeded=!0,!1)},t.prototype.updateCropBounds=function(){var t=this.cropper.getCropBounds();this.cropPositionChange.emit(new p.a(t.left,t.top,t.width,t.height)),this.isCropPositionUpdateNeeded=!1},t.prototype.getOrientedImage=function(t,e){var i;c.getData(t,function(){var s=c.getTag(t,\"Orientation\");if([3,6,8].indexOf(s)>-1){var o=document.createElement(\"canvas\"),r=o.getContext(\"2d\"),n=t.width,a=t.height,h=0,p=0,g=0;switch(s){case 3:h=-t.width,p=-t.height,g=180;break;case 6:n=t.height,a=t.width,p=-t.height,g=90;break;case 8:n=t.height,a=t.width,h=-t.width,g=270}o.width=n,o.height=a,r.rotate(g*Math.PI/180),r.drawImage(t,h,p),(i=document.createElement(\"img\")).width=n,i.height=a,i.addEventListener(\"load\",function(){e(i)}),i.src=o.toDataURL(\"image/png\")}else e(i=t)})},t}()},sUGQ:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return o});var s=i(\"uzy7\"),o=function(){function t(t){this.canvasWidth=300,this.canvasHeight=300,this.dynamicSizing=!1,this.width=200,this.height=200,this.minWidth=50,this.minHeight=50,this.minWithRelativeToResolution=!0,this.croppedWidth=100,this.croppedHeight=100,this.cropperDrawSettings=new s.a,this.touchRadius=20,this.noFileInput=!1,this.markerSizeMultiplier=1,this.centerTouchRadius=20,this.showCenterMarker=!0,this.allowedFilesRegex=/\\.(jpe?g|png|gif|bmp)$/i,this.cropOnResize=!0,this.preserveSize=!1,this.compressRatio=1,this._rounded=!1,this._keepAspect=!0,\"object\"==typeof t&&Object.assign(this,t)}return Object.defineProperty(t.prototype,\"rounded\",{get:function(){return this._rounded},set:function(t){this._rounded=t,t&&(this._keepAspect=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"keepAspect\",{get:function(){return this._keepAspect},set:function(t){this._keepAspect=t,!0===this._rounded&&!1===this._keepAspect&&(console.error(\"Cannot set keep aspect to false on rounded cropper. Ellipsis not supported\"),this._keepAspect=!0)},enumerable:!0,configurable:!0}),t}()},uzy7:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return s});var s=function(t){this.lineDash=!1,this.strokeWidth=1,this.strokeColor=\"rgba(255,255,255,1)\",this.dragIconStrokeWidth=1,this.dragIconStrokeColor=\"rgba(0,0,0,1)\",this.dragIconFillColor=\"rgba(255,255,255,1)\",\"object\"==typeof t&&(this.lineDash=t.lineDash||this.lineDash,this.strokeWidth=t.strokeWidth||this.strokeWidth,this.strokeColor=t.strokeColor||this.strokeColor,this.dragIconStrokeWidth=t.dragIconStrokeWidth||this.dragIconStrokeWidth,this.dragIconStrokeColor=t.dragIconStrokeColor||this.dragIconStrokeColor,this.dragIconFillColor=t.dragIconFillColor||this.dragIconFillColor)}},wmy0:function(t,e,i){\"use strict\";i.d(e,\"a\",function(){return o});var s=i(\"1XgG\"),o=function(){function t(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.left=t,this.right=t+i,this.top=e,this.bottom=e+s}return Object.defineProperty(t.prototype,\"width\",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"height\",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0}),t.prototype.getCentre=function(){return s.a.instance.borrow(this.left+this.width/2,this.top+this.height/2)},t}()}}]);","extractedComments":[]}